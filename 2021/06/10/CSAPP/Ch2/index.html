<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Ch2 | RainbowBin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="MathJax.Hub.Config({ tex2jax: {inlineMath: [[&#39;$&#39;, &#39;$&#39;]]}, messageStyle: &quot;none&quot; });  Representing and Manipulating Information">
<meta property="og:type" content="article">
<meta property="og:title" content="Ch2">
<meta property="og:url" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/index.html">
<meta property="og:site_name" content="RainbowBin">
<meta property="og:description" content="MathJax.Hub.Config({ tex2jax: {inlineMath: [[&#39;$&#39;, &#39;$&#39;]]}, messageStyle: &quot;none&quot; });  Representing and Manipulating Information">
<meta property="og:locale">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/hexadecimal.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/wrong.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/csize.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/endian.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/machines.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/light.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/shift.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/terminology.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/range.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/importantnums.png">
<meta property="og:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/versus.png">
<meta property="article:published_time" content="2021-06-10T15:41:08.000Z">
<meta property="article:modified_time" content="2021-07-23T11:12:28.597Z">
<meta property="article:author" content="rubbish">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/hexadecimal.png">
  
    <link rel="alternate" href="/atom.xml" title="RainbowBin" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">RainbowBin</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://rubbish-and-world.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-CSAPP/Ch2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/06/10/CSAPP/Ch2/" class="article-date">
  <time class="dt-published" datetime="2021-06-10T15:41:08.000Z" itemprop="datePublished">2021-06-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/csapp/">csapp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Ch2
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: {inlineMath: [['$', '$']]}, messageStyle: "none" });</script>

<h1 id="Representing-and-Manipulating-Information"><a href="#Representing-and-Manipulating-Information" class="headerlink" title="Representing and Manipulating Information"></a>Representing and Manipulating Information</h1><a id="more"></a>



<p>[TOC]</p>
<p><em>In isolation, a single bit is not very useful. When we group bits together and apply some interpretation that gives meaning to the different possible bit patterns, however, we can represent the elements of any <strong>finite set</strong>.</em></p>
<p>We will mainly focus on three most important representations of numbers:</p>
<ul>
<li>Unsigned –&gt; traditional binary notation</li>
<li>Signed –&gt; 2’s complement</li>
<li>Floating-point –&gt; base-2 version of scientific notation(IEEE)</li>
</ul>
<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p><em>just get some feeling of our dear computer</em></p>
<ul>
<li><p>numbers in computer is finite, so sometimes result will overflow</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;200*300*400*500=%d\n&quot;</span> ,<span class="number">200</span>*<span class="number">300</span>*<span class="number">400</span>*<span class="number">500</span> );</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;(3.14+1e20)-1e20=%f\n&quot;</span> ,(<span class="number">3.14</span>+<span class="number">1e20</span>)<span class="number">-1e20</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;3.14+(1e20-1e20)=%f\n&quot;</span> ,<span class="number">3.14</span>+(<span class="number">1e20</span><span class="number">-1e20</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">200*300*400*500&#x3D;-884901888</span><br><span class="line">(3.14+1e20)-1e20&#x3D;0.000000</span><br><span class="line">3.14+(1e20-1e20)&#x3D;3.140000</span><br></pre></td></tr></table></figure>
<p>The different mathematical properties of integer versus floating-point arithmetic stem from <strong>the difference in how they handle the finiteness of their representations</strong></p>
<ul>
<li>integer representations can encode a comparatively small range of values, but do so precisely</li>
<li> floating-point representations can encode a wide range of values, but only approximately.</li>
</ul>
</li>
<li><p>A number of computer security <strong>vulnerabilities</strong> have arisen due to some of the subtleties of computer arithmetic.</p>
</li>
<li><p>Computers use several different binary representations to encode numeric values. <strong>You will need to be familiar with these representations as you progress into machine-level programming</strong></p>
</li>
<li><p> programmers need to have a clear understanding of <strong>how computer arithmetic relates to the more familiar integer and real arithmetic.</strong></p>
</li>
<li><p>Everything said in this chapter about C also holds for C++. The Java language definition, on the other hand, created a new set of standards for numeric representations and operations.</p>
</li>
</ul>
<h2 id="2-1-Information-Storage"><a href="#2-1-Information-Storage" class="headerlink" title="2.1 Information Storage"></a>2.1 Information Storage</h2><p><em>Rather than modifying individual bit, most modern computers use <strong>blocks of 8 bits, or bytes, as the smallest addressable unit of memory</strong></em></p>
<h3 id="2-1-1-Hexadecimal-Notation"><a href="#2-1-1-Hexadecimal-Notation" class="headerlink" title="2.1.1 Hexadecimal Notation"></a>2.1.1 Hexadecimal Notation</h3><p><img src="/2021/06/10/CSAPP/Ch2/hexadecimal.png" alt="hex"></p>
<p><strong><em>One simple trick for doing the conversion in your head is to memorize the decimal equivalents of hex digits A, C, and F. The hex values B, D, and E can be translated to decimal by computing their values relative to the first three.</em></strong></p>
<p>If the total number of bits is not a multiple of 4, you should make the <strong>leftmost</strong> group be the one with fewer than 4 bits, effectively <strong>padding the number with leading zeros</strong>. </p>
<hr>
<h4 id="Practice-Problem-2-1"><a href="#Practice-Problem-2-1" class="headerlink" title="Practice Problem 2.1"></a>Practice Problem 2.1</h4><blockquote>
<p>Perform the following number conversions: </p>
<p>A. 0x25B9D2 to binary </p>
<p>B. binary 1010111001001001 to hexadecimal </p>
<p>C. 0xA8B3D to binary </p>
<p>D. binary 1100100010110110010110 to hexadecimal</p>
</blockquote>
<h4 id="My-solution-white-check-mark"><a href="#My-solution-white-check-mark" class="headerlink" title="My solution::white_check_mark:"></a>My solution::white_check_mark:</h4><p>$$<br>A:(25B9D2)_{16} = (0010 0101 1011 1001 1101 0010)_2<br>$$</p>
<p>$$<br>B : (1010 1110 0100 1001)<em>2 = (AE49)</em>{16}<br>$$</p>
<p>$$<br>C: (A8B3D)_{16} = (1010 1000 1011 0011 1101)_2<br>$$</p>
<p>$$<br>D : (11 0010 0010 1101 1001 0110)_2 = (0011 0010 0010 1101 1001 0110)<em>2 = (322D96)</em>{16}<br>$$</p>
<p><span style="color:red">(solution on the book is wrong)</span></p>
<p><img src="/2021/06/10/CSAPP/Ch2/wrong.png" alt="wrong"></p>
<hr>
<p>When a value <strong>x is a power of 2</strong>, that is, $x = 2^n$ for some nonnegative integer n, we can readily write x in hexadecimal form by remembering that the binary representation of x is simply <strong>1 followed by n zeros</strong>.</p>
<p>The hexadecimal digit 0 represents 4 binary zeros.</p>
<p>1 hexadecimal 0 is equals to $2^4$</p>
<p>So, for n written in the form i + 4j , where 0 ≤ i ≤ 3, we can write x with a leading hex digit of 1 (i = 0), 2 (i = 1), 4 (i = 2), or 8 (i = 3), followed by j hexadecimal 0s.<br>$$<br>(2^i)\underbrace{000…000}_\text{j zeros}<br>$$</p>
<hr>
<h4 id="Practice-Problem-2-2"><a href="#Practice-Problem-2-2" class="headerlink" title="Practice Problem 2.2"></a>Practice Problem 2.2</h4><blockquote>
<p>Fill in the blank entries in the following table, giving the decimal and hexadecimal representations of different powers of 2:</p>
<table>
<thead>
<tr>
<th>n</th>
<th>$2^n$(decimal)</th>
<th>$2^n$(hexadecimal)</th>
</tr>
</thead>
<tbody><tr>
<td>5</td>
<td>32</td>
<td>0x20</td>
</tr>
<tr>
<td>23</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>32768</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>0x2000</td>
</tr>
<tr>
<td>12</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>64</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>0x100</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-1"><a href="#My-solution-white-check-mark-1" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>$$<br>2^{23} = 2^3\times2^{10} \times 2^{10}= 8 \times 1048576 = 8388608<br>$$</p>
<p>$$<br>23 = 3 + 4 \times 5 , 2^{23} = (800000)_{16}<br>$$</p>
<p>$$<br>\log_2 (32768) = 15<br>$$</p>
<p>$$<br>15 = 3 + 3\times4 , 2^{15} = (8000)_{16}<br>$$</p>
<p>$$<br>(2000)<em>{16} = 2^{1+3\times4} = 2^{13} = 2^3 \times 2^{10} = (8192)</em>{10}<br>$$</p>
<p>$$<br>2^{12} = 4 \times 1024 = 4096<br>$$</p>
<p>$$<br>12 = 0 + 3\times 4, 2^{12} = (1000)_{16}<br>$$</p>
<p>$$<br>\log_2 {64} = 6<br>$$</p>
<p>$$<br>6 = 2+1\times 4 , 2^{6} = (40)_{16}<br>$$</p>
<p>$$<br>(100)_{16} = 2^{0+2\times4} = 256<br>$$</p>
<table>
<thead>
<tr>
<th>n</th>
<th>$2^n$(decimal)</th>
<th>$2^n$(hexadecimal)</th>
</tr>
</thead>
<tbody><tr>
<td>5</td>
<td>32</td>
<td>0x20</td>
</tr>
<tr>
<td>23</td>
<td>8388608</td>
<td>0x800000</td>
</tr>
<tr>
<td>15</td>
<td>32768</td>
<td>0x8000</td>
</tr>
<tr>
<td>13</td>
<td>8192</td>
<td>0x2000</td>
</tr>
<tr>
<td>12</td>
<td>4096</td>
<td>0x1000</td>
</tr>
<tr>
<td>6</td>
<td>64</td>
<td>0x40</td>
</tr>
<tr>
<td>8</td>
<td>256</td>
<td>0x100</td>
</tr>
</tbody></table>
<hr>
<p>Converting between decimal and hexadecimal representations requires using multiplication or division to handle the general case.</p>
<p>(just the same method used when we convert between binary and decimal)</p>
<hr>
<h4 id="Practice-Problem-2-3"><a href="#Practice-Problem-2-3" class="headerlink" title="Practice Problem 2.3"></a>Practice Problem 2.3</h4><blockquote>
<p>A single byte can be represented by 2 hexadecimal digits. </p>
<p>Fill in the missing entries in the following table, giving the decimal, binary, and hexadecimal values of different byte patterns:</p>
<table>
<thead>
<tr>
<th>Decimal</th>
<th>Binary</th>
<th>Hexadecimal</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0000 0000</td>
<td>0x00</td>
</tr>
<tr>
<td>158</td>
<td></td>
<td></td>
</tr>
<tr>
<td>76</td>
<td></td>
<td></td>
</tr>
<tr>
<td>145</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>1010 1110</td>
<td></td>
</tr>
<tr>
<td></td>
<td>0011 1100</td>
<td></td>
</tr>
<tr>
<td></td>
<td>1111 0001</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>0x75</td>
</tr>
<tr>
<td></td>
<td></td>
<td>0xBD</td>
</tr>
<tr>
<td></td>
<td></td>
<td>0xF5</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-2"><a href="#My-solution-white-check-mark-2" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>$$<br>158 = 9 \times 16 + 14(E)<br>$$</p>
<p>$$<br>9 = 0 \times 16 + 9 (9)<br>$$</p>
<p>$$<br>158 = (9E)_{16}<br>$$</p>
<table>
<thead>
<tr>
<th>Decimal</th>
<th>Binary</th>
<th>Hexadecimal</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0000 0000</td>
<td>0x00</td>
</tr>
<tr>
<td>158</td>
<td>1001 1110</td>
<td>0x9E</td>
</tr>
<tr>
<td>76</td>
<td>0100 1100</td>
<td>0x4C</td>
</tr>
<tr>
<td>145</td>
<td>1001 0001</td>
<td>0x91</td>
</tr>
<tr>
<td>174</td>
<td>1010 1110</td>
<td>0xAE</td>
</tr>
<tr>
<td>60</td>
<td>0011 1100</td>
<td>0x3C</td>
</tr>
<tr>
<td>241</td>
<td>1111 0001</td>
<td>0xF1</td>
</tr>
<tr>
<td>117</td>
<td>0111 0101</td>
<td>0x75</td>
</tr>
<tr>
<td>189</td>
<td>1011 1101</td>
<td>0xBD</td>
</tr>
<tr>
<td>245</td>
<td>1111 0101</td>
<td>0xF5</td>
</tr>
</tbody></table>
<h4 id="Practice-Problem-2-4"><a href="#Practice-Problem-2-4" class="headerlink" title="Practice Problem 2.4"></a>Practice Problem 2.4</h4><blockquote>
<p>Without converting the numbers to decimal or binary, try to solve the following arithmetic problems, giving the answers in hexadecimal. Hint: Just modify the methods you use for performing decimal addition and subtraction to use base 16.</p>
<p>A. 0x605c + 0x5 = </p>
<p>B. 0x605c − 0x20 = </p>
<p>C. 0x605c + 32 = </p>
<p>D. 0x60fa − 0x605c =</p>
</blockquote>
<h4 id="My-solution-white-check-mark-3"><a href="#My-solution-white-check-mark-3" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>$$<br>A : (605C)<em>{16} + (5)</em>{16} = (6061)_{16}<br>$$</p>
<p>B. 0x605c − 0x20 = 0x603c</p>
<p>C. 0x605c + 32 = 0x605c + 0x20 = 0x607c<br>$$<br>+60FA\<br>-605C\<br>\rule{4cm}{0.4pt}\<br>    +009E<br>$$<br>D. 0x60fa − 0x605c = 0x9E</p>
<p><em>just normal arithmetic with base 16</em></p>
<hr>
<h3 id="2-1-2-Data-Sizes"><a href="#2-1-2-Data-Sizes" class="headerlink" title="2.1.2 Data Sizes"></a>2.1.2 Data Sizes</h3><ul>
<li><p>Every computer has a <strong>word size</strong>, and a virtual address is encoded by such a word, so <strong>word size</strong> determine <strong>the maximum size of the virtual address space.</strong></p>
</li>
<li><p> For a machine with a w-bit word size, the virtual addresses can range from 0 to $2^w − 1$, giving the program access to at most $2^w$ bytes.</p>
</li>
<li><p>We will therefore refer to programs as being either “32-bit programs” or “64-bit programs,” since the distinction lies in how a program is compiled, rather than the type of machine on which it runs.</p>
<ul>
<li>32-bits program : <code>linux&gt;gcc -m32 program.c</code></li>
<li>64-bits program : <code>linux&gt;gcc -m64 program.c</code></li>
<li>Nowadays <code>32-bits</code> seems to be deprecated and gcc default compile it as <code>64-bits</code>, the <code>-m32</code> parameter will result in missing file error on 64 bits machine.</li>
</ul>
</li>
<li><p>To avoid the vagaries of relying on “typical” sizes and different compiler settings, ISO C99 introduced a class of data types where the data sizes are fixed regardless of compiler and machine settings : <code>int32_t</code> and <code>int64_t</code>,having exactly 4 and 8 bytes, respectively.</p>
<p>Using fixed-size integer types is the best way for programmers to have close control over data representations.</p>
<p><img src="/2021/06/10/CSAPP/Ch2/csize.png" alt="csize"></p>
</li>
<li><p>One aspect of portability is to make the program <strong>insensitive to the exact sizes of the different data types.</strong></p>
<p>For example, many programmers historically assumed that an object declared as type int could be used to store a pointer. This works fine for most 32-bit programs, but it leads to problems for 64-bit programs.</p>
<p>(the size of virtual address space differs!)</p>
<p>(check size by using <code>sizeof()</code> before use it may be a good trick.)</p>
</li>
</ul>
<h3 id="2-1-3-Addressing-and-Byte-Ordering"><a href="#2-1-3-Addressing-and-Byte-Ordering" class="headerlink" title="2.1.3 Addressing and Byte Ordering"></a>2.1.3 Addressing and Byte Ordering</h3><h4 id="Byte-ordering"><a href="#Byte-ordering" class="headerlink" title="Byte ordering"></a>Byte ordering</h4><ul>
<li><p>where the least significant byte comes first—is referred to as little endian.</p>
<p>where the most significant byte comes first—is referred to as big endian.</p>
</li>
<li><p>Example</p>
<p><img src="/2021/06/10/CSAPP/Ch2/endian.png" alt="endian"></p>
</li>
<li><p>Many recent microprocessor chips are <strong>bi-endian</strong>, meaning that they can <strong>be configured to operate as either little- or big-endian machines</strong>. In practice, however, <strong>byte ordering becomes fixed once a particular operating system is chosen.</strong></p>
<p> For example, ARM microprocessors, used in many cell phones, have hardware that can operate in either little- or big-endian mode, but the two most common operating systems for these chips—Android (from Google) and IOS (from Apple)—operate only in little-endian mode.</p>
</li>
<li><p> Just like the egg issue, there is <strong>no technological reason</strong> to choose one byte ordering convention over the other</p>
</li>
</ul>
<h5 id="Three-case-when-byte-ordering-matters"><a href="#Three-case-when-byte-ordering-matters" class="headerlink" title="Three case when byte ordering matters"></a>Three case when byte ordering matters</h5><ul>
<li><p>code written for <strong>networking</strong> applications must follow established conventions for byte ordering to make sure the sending machine converts its internal representation to the network standard, while the receiving machine converts the network standard to its internal representation.</p>
</li>
<li><p>when <strong>inspecting machine-level programs</strong>, especially codes provided by a disassemble, the byte sequences representing integer data are related to endian.</p>
<p>For example</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4004d3: 01 05 43 0b 20 00 add %eax,0x200b43(%rip)</span><br></pre></td></tr></table></figure>
<p>little endian reads it as <code>add eax,0x00200b43</code>, while big endian will reads it as <code>add eax,0x430b2000</code></p>
</li>
<li><p>when programs are written that <strong>circumvent the normal type system</strong>.</p>
<p> In the C language, this can be done using a cast or a union to allow an object to be referenced according to a different data type from which it was created.</p>
<p>Such coding tricks are strongly discouraged for most application programming, but they can be quite useful and even necessary for system-level programming.</p>
<p><img src="/2021/06/10/CSAPP/Ch2/machines.png" alt="machines"> </p>
</li>
</ul>
<hr>
<h4 id="Practice-Problem-2-5"><a href="#Practice-Problem-2-5" class="headerlink" title="Practice Problem 2.5"></a>Practice Problem 2.5</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> *byte_pointer;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_bytes</span><span class="params">(byte_pointer start, <span class="keyword">size_t</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot; %.2x&quot;</span>, start[i]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_int</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">show_bytes((byte_pointer) &amp;x, <span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_float</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</span><br><span class="line">show_bytes((byte_pointer) &amp;x, <span class="keyword">sizeof</span>(<span class="keyword">float</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_pointer</span><span class="params">(<span class="keyword">void</span> *x)</span> </span>&#123;</span><br><span class="line">show_bytes((byte_pointer) &amp;x, <span class="keyword">sizeof</span>(<span class="keyword">void</span> *));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Consider the following three calls to show_bytes: </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">0x12345678</span>; </span><br><span class="line">byte_pointer ap = (byte_pointer) &amp;a;</span><br><span class="line">show_bytes(ap, <span class="number">1</span>); <span class="comment">/* A. */</span> </span><br><span class="line">show_bytes(ap, <span class="number">2</span>); <span class="comment">/* B. */</span> </span><br><span class="line">show_bytes(ap, <span class="number">3</span>); <span class="comment">/* C. */</span></span><br></pre></td></tr></table></figure>

<p> Indicate the values that will be printed by each call on a little-endian machine and on a big-endian machine: </p>
<p>A. Little endian: ? Big endian: ?</p>
<p>B. Little endian: ? Big endian: ?</p>
<p>C. Little endian: ?  Big endian: ?</p>
</blockquote>
<h4 id="My-solution-white-check-mark-4"><a href="#My-solution-white-check-mark-4" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>A. Little endian: 78 Big endian: 12</p>
<p>B. Little endian: 78 56 Big endian: 12 34</p>
<p>C. Little endian: 78 56 34  Big endian: 12 34 56</p>
<h4 id="Practice-Problem-2-6"><a href="#Practice-Problem-2-6" class="headerlink" title="Practice Problem 2.6"></a>Practice Problem 2.6</h4><blockquote>
<p>Using <code>show_int</code> and <code>show_float</code>, we determine that the integer 2607352 has hexadecimal representation 0x0027C8F8, while the floating-point number 3510593.0 has hexadecimal representation 0x4A1F23E0. </p>
<p>A. Write the binary representations of these two hexadecimal values. </p>
<p>B. Shift these two strings relative to one another to maximize the number of matching bits. How many bits match? </p>
<p>C. What parts of the strings do not match?</p>
</blockquote>
<h4 id="My-solution-white-check-mark-5"><a href="#My-solution-white-check-mark-5" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>A:<br>$$<br>(0027C8F8)_{16} = (0000 0000 0010 0111 1100 1000 1111 1000)_2<br>$$</p>
<p>$$<br>(4A1F23E0)_{16} = (0100 1010 0001 1111 0010 0011 1110 0000)_2<br>$$</p>
<p>B:</p>
<p>right shift the second one 2 bits</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">00000000001001111100100011111000</span><br><span class="line">  01001010000111110010001111100000</span><br></pre></td></tr></table></figure>
<p>21 bits match</p>
<p>C:</p>
<p>(according to IEEE the signed bit , exponent bits and the hidden 1 in mantissa do not match)</p>
<h3 id="2-1-4-Representing-Strings"><a href="#2-1-4-Representing-Strings" class="headerlink" title="2.1.4 Representing Strings"></a>2.1.4 Representing Strings</h3><p><em>A string in C is encoded by an array of characters terminated by the null (having value 0) character.</em></p>
<ul>
<li>ASCII code for decimal digit $x$ happens to be 0x3$x$, and that the terminating byte has the hex representation 0x00</li>
<li> Text data are more platform independent than binary data. It has nothing to do with byte ordering. It is always a sequence.</li>
<li>It is someting can be viewed as big endian.</li>
</ul>
<hr>
<h4 id="Practice-Problem-2-7"><a href="#Practice-Problem-2-7" class="headerlink" title="Practice Problem 2.7"></a>Practice Problem 2.7</h4><blockquote>
<p>What would be printed as a result of the following call to <code>show_bytes</code>? </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *m = <span class="string">&quot;mnopqr&quot;</span>; show_bytes((byte_pointer) m, <span class="built_in">strlen</span>(m));</span><br></pre></td></tr></table></figure>

<p> Note that letters ‘a’ through ‘z’ have ASCII codes 0x61 through 0x7A</p>
</blockquote>
<h4 id="My-solution"><a href="#My-solution" class="headerlink" title="My solution:"></a>My solution:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6d 6e 6f 70 71 72</span><br></pre></td></tr></table></figure>
<p><strong>Recall also that the library routine strlen does NOT count the terminating null character</strong></p>
<hr>
<h3 id="2-1-5-Representing-Code"><a href="#2-1-5-Representing-Code" class="headerlink" title="2.1.5 Representing Code"></a>2.1.5 Representing Code</h3><p>Consider the following C function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> x , <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When compiled on our sample machines, we generate machine code having the following byte representations:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Linux32 	55 89 e5 8b 45 0c 03 45 08 c9 c3</span><br><span class="line">Windows 	55 89 e5 8b 45 0c 03 45 08 5d c3</span><br><span class="line">Sun 		81 c3 e0 08 90 02 00 09</span><br><span class="line">Linux64 	55 48 89 e5 89 7d fc 89 75 f8 03 45 fc c9 c3</span><br></pre></td></tr></table></figure>
<p><strong>Different machine types use different and incompatible instructions and encodings. Even identical processors running different operating systems have differences in their coding conventions and hence are not binary compatible.</strong></p>
<p><em>A fundamental concept of computer systems is that a program, from the perspective of the machine, is simply <strong>a sequence of bytes</strong>.</em></p>
<h3 id="2-1-6-Introduction-to-Boolean-Algebra"><a href="#2-1-6-Introduction-to-Boolean-Algebra" class="headerlink" title="2.1.6 Introduction to Boolean Algebra"></a>2.1.6 Introduction to Boolean Algebra</h3><hr>
<h4 id="Practice-Problem-2-8"><a href="#Practice-Problem-2-8" class="headerlink" title="Practice Problem 2.8"></a>Practice Problem 2.8</h4><blockquote>
<p>Fill in the following table showing the results of evaluating Boolean operations on bit vectors.</p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Result</th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>[01001110]</td>
</tr>
<tr>
<td>b</td>
<td>[11100001]</td>
</tr>
<tr>
<td>~a</td>
<td></td>
</tr>
<tr>
<td>~b</td>
<td></td>
</tr>
<tr>
<td>a&amp;b</td>
<td></td>
</tr>
<tr>
<td>a|b</td>
<td></td>
</tr>
<tr>
<td>a^b</td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-6"><a href="#My-solution-white-check-mark-6" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><table>
<thead>
<tr>
<th>Operation</th>
<th>Result</th>
</tr>
</thead>
<tbody><tr>
<td>a</td>
<td>[01001110]</td>
</tr>
<tr>
<td>b</td>
<td>[11100001]</td>
</tr>
<tr>
<td>~a</td>
<td>[10110001]</td>
</tr>
<tr>
<td>~b</td>
<td>[00011110]</td>
</tr>
<tr>
<td>a&amp;b</td>
<td>[01000000]</td>
</tr>
<tr>
<td>a|b</td>
<td>[11101111]</td>
</tr>
<tr>
<td>a^b</td>
<td>[10101111]</td>
</tr>
</tbody></table>
<h4 id="Practice-Problem-2-9"><a href="#Practice-Problem-2-9" class="headerlink" title="Practice Problem 2.9"></a>Practice Problem 2.9</h4><blockquote>
<p>Computers generate color pictures on a video screen or liquid crystal display by mixing three different colors of light: red, green, and blue. Imagine a simple scheme, with three different lights, each of which can be turned on or off, projecting onto a glass screen:</p>
<p><img src="/2021/06/10/CSAPP/Ch2/light.png" alt="light"></p>
<p>We can then create eight different colors based on the absence (0) or presence (1) of light sources R, G, and B:</p>
<table>
<thead>
<tr>
<th>Red</th>
<th>Green</th>
<th>Blue</th>
<th>Color</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Black</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>Blue</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>Green</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>1</td>
<td>Cyan</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Red</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td>Magenta</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>Yellow</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>White</td>
</tr>
</tbody></table>
<p>Each of these colors can be represented as a bit vector of length 3, and we can apply Boolean operations to them.</p>
<p>A. The complement of a color is formed by turning off the lights that are on and turning on the lights that are off. What would be the complement of each of the eight colors listed above? </p>
<p>B. Describe the effect of applying Boolean operations on the following colors:</p>
<p>Blue | Green = </p>
<p>Yellow &amp; Cyan =</p>
<p>Red ^ Magenta =</p>
</blockquote>
<h4 id="My-solution-white-check-mark-7"><a href="#My-solution-white-check-mark-7" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>A:</p>
<table>
<thead>
<tr>
<th>Red</th>
<th>Green</th>
<th>Blue</th>
<th>Color</th>
<th>Complement Color</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>Black</td>
<td>White</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>Blue</td>
<td>Yellow</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>Green</td>
<td>Magenta</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>1</td>
<td>Cyan</td>
<td>Red</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
<td>Red</td>
<td>Cyan</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>1</td>
<td>Magenta</td>
<td>Green</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>Yellow</td>
<td>Blue</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>White</td>
<td>Black</td>
</tr>
</tbody></table>
<p>B:</p>
<p>Blue | Green = 001 | 010 = 011 = Cyan</p>
<p>Yellow &amp; Cyan = 110 &amp; 011 = 010 = Green</p>
<p>Red ^ Magenta = 100 ^ 101 = 001 = Blue</p>
<hr>
<h3 id="2-1-7-Bit-Level-Operations-in-C"><a href="#2-1-7-Bit-Level-Operations-in-C" class="headerlink" title="2.1.7 Bit-Level Operations in C"></a>2.1.7 Bit-Level Operations in C</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inplace_swap</span><span class="params">(<span class="keyword">int</span> *x, <span class="keyword">int</span> *y)</span> </span>&#123;</span><br><span class="line">*y = *x ^ *y; <span class="comment">/* Step 1 */</span></span><br><span class="line">*x = *x ^ *y; <span class="comment">/* Step 2 */</span></span><br><span class="line">*y = *x ^ *y; <span class="comment">/* Step 3 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong><em>There is NO performance advantage to this way of swapping; it is merely an intellectual amusement!!!</em></strong></p>
<table>
<thead>
<tr>
<th>Step</th>
<th>*x</th>
<th>*y</th>
</tr>
</thead>
<tbody><tr>
<td>Initial</td>
<td>a</td>
<td>b</td>
</tr>
<tr>
<td>Step 1</td>
<td>a</td>
<td>a^b</td>
</tr>
<tr>
<td>Step 2</td>
<td>a^a^b=b</td>
<td>a^b</td>
</tr>
<tr>
<td>Step 3</td>
<td>b</td>
<td>b^a^b=a</td>
</tr>
</tbody></table>
<hr>
<h4 id="Practice-Problem-2-11"><a href="#Practice-Problem-2-11" class="headerlink" title="Practice Problem 2.11"></a>Practice Problem 2.11</h4><blockquote>
<p>Armed with the function <code>inplace_swap</code> from Problem 2.10, you decide to write code that will reverse the elements of an array by swapping elements from opposite ends of the array, working toward the middle. You arrive at the following function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse_array</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> cnt)</span> </span>&#123;    </span><br><span class="line"><span class="keyword">int</span> first, last;      </span><br><span class="line"><span class="keyword">for</span> (first = <span class="number">0</span>, last = cnt<span class="number">-1</span>;  first &lt;= last;first++,last--)      </span><br><span class="line">	inplace_swap(&amp;a[first], &amp;a[last]);      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When you apply your function to an array containing elements 1, 2, 3, and 4, you find the array now has, as expected, elements 4, 3, 2, and 1. When you try it on an array with elements 1, 2, 3, 4, and 5, however, you are surprised to see that the array now has elements 5, 4, 0, 2, and 1. In fact, you discover that the code always works correctly on arrays of even length, but it sets the middle element to 0 whenever the array has odd length.</p>
<p>A. For an array of odd length cnt = 2k + 1, what are the values of variables first and last in the final iteration of function reverse_array? </p>
<p>B. Why does this call to function inplace_swap set the array element to 0? </p>
<p>C. What simple modification to the code for reverse_array would eliminate this problem?</p>
</blockquote>
<h4 id="My-solution-white-check-mark-8"><a href="#My-solution-white-check-mark-8" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>A: first = last = (2k+1-1)/2 = k</p>
<p>B: because <code>inplace_swap</code> use <code>^</code> to facilitate swapping rather than more reliable <code>int temp</code> variable, at the first step we set the value to <code>a^a=0</code>, and then we play with <code>0</code> all the time.</p>
<p>C: change <code>first &lt;= last</code> to <code>first &lt; last</code></p>
<hr>
<h5 id="Mask"><a href="#Mask" class="headerlink" title="Mask"></a>Mask</h5><p>One common use of bit-level operations is to implement <strong>masking</strong> operations, where a mask is <strong>a bit pattern that indicates a selected set of bits within a word</strong>.</p>
<p>As an example, the mask 0xFF (having ones for the least significant 8 bits) indicates the low-order byte of a word. The bit-level operation x &amp; 0xFF yields a value consisting of the least significant byte of x, but with all other bytes set to 0.</p>
<h4 id="Practice-Problem-2-12"><a href="#Practice-Problem-2-12" class="headerlink" title="Practice Problem 2.12"></a>Practice Problem 2.12</h4><blockquote>
<p>Write C expressions, in terms of variable <code>x</code>, for the following values. <strong>Your code should work for any word size w ≥ 8</strong>. For reference, we show the result of evaluating the expressions for x = 0x87654321, with w = 32.</p>
<p>A. The least significant byte of x, with all other bits set to 0. [0x00000021] </p>
<p>B. All but the least significant byte of x complemented, with the least significant byte left unchanged. [0x789ABC21]</p>
<p>C. The least significant byte set to all ones, and all other bytes of x left unchanged. [0x876543FF]</p>
</blockquote>
<h4 id="My-solution-warning"><a href="#My-solution-warning" class="headerlink" title="My solution: :warning:"></a>My solution: :warning:</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;    </span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;    </span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> x = <span class="number">0x87654321</span> ; <span class="comment">//w = 32    </span></span><br><span class="line">    <span class="keyword">uint64_t</span> y = <span class="number">0xFEDCBA9876543210</span>; <span class="comment">// w = 64    </span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;32 bits : 0x%x , 64 bits : 0x%llx\n&quot;</span> , x , y);    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//A:    </span></span><br><span class="line">    x &amp;= <span class="number">0xff</span>; y &amp;= <span class="number">0xff</span>;    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;32 bits : 0x%x , 64 bits : 0x%llx\n&quot;</span> , x , y);    </span><br><span class="line">    x = <span class="number">0x87654321</span>;    </span><br><span class="line">    y = <span class="number">0xFEDCBA9876543210</span>;                                                              </span><br><span class="line">    <span class="comment">//B:                                                                                 </span></span><br><span class="line">    x = ((x &amp; <span class="number">0xff</span>) | ~<span class="number">0xff</span>) &amp; ~(x &amp; ~<span class="number">0xff</span>);                                             </span><br><span class="line">    y = ((y &amp; <span class="number">0xff</span>) | ~<span class="number">0xff</span>) &amp; ~(y &amp; ~<span class="number">0xff</span>);                                             </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;32 bits : 0x%x , 64 bits : 0x%llx\n&quot;</span> , x , y);                               </span><br><span class="line">    x = <span class="number">0x87654321</span>;                                                                      </span><br><span class="line">    y = <span class="number">0xFEDCBA9876543210</span>;                                                              </span><br><span class="line">    <span class="comment">//C:                                                                                 </span></span><br><span class="line">    x |= <span class="number">0xff</span>;                                                                           </span><br><span class="line">    y |= <span class="number">0xff</span>;                                                                           </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;32 bits : 0x%x , 64 bits : 0x%llx\n&quot;</span> , x , y);                               </span><br><span class="line">                                                                                         </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;                                                                            </span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">32 bits : 0x87654321 , 64 bits : 0xfedcba9876543210</span><br><span class="line">32 bits : 0x21 , 64 bits : 0x10</span><br><span class="line">32 bits : 0x789abc21 , 64 bits : 0x123456789abcd10</span><br><span class="line">32 bits : 0x876543ff , 64 bits : 0xfedcba98765432ff</span><br></pre></td></tr></table></figure>
<p><span style="color:red">solution B can be simplified</span><br>$$<br>f = ((x \cdot FF)+\overline{FF}) \cdot \overline{x \cdot \overline {FF}}<br>$$</p>
<p>$$<br>f = ((x+\overline{FF}) \cdot (FF + \overline{FF})) \cdot (\bar{x}+FF)<br>$$</p>
<p>$$<br>f = (x+\overline{FF})\cdot (\bar{x}+FF)<br>$$</p>
<p>$$<br>f = x\cdot \bar{x} + (x\cdot FF)+(\overline{FF}\cdot \bar{x})+FF\cdot\overline{FF}<br>$$</p>
<p>$$<br>f = (x\cdot FF)+(\bar{x}\cdot\overline{FF} )=\overline{x\oplus FF}<br>$$</p>
<p><span style="color:red">solution to question B:</span></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x ^ ~<span class="number">0xFF</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a ^ <span class="number">0</span> = a</span><br><span class="line">a ^ <span class="number">1</span> = ~a </span><br></pre></td></tr></table></figure>
<ul>
<li> The expression <code>~0</code> will yield a mask of all ones, <strong>regardless of the size of the data representation.</strong></li>
<li>when your expression become very long, try to simplify it.</li>
</ul>
<hr>
<h4 id="Practice-Problem-2-13"><a href="#Practice-Problem-2-13" class="headerlink" title="Practice Problem 2.13"></a>Practice Problem 2.13</h4><blockquote>
<p>The Digital Equipment VAX computer was a very popular machine from the late 1970s until the late 1980s. Rather than instructions for Boolean operations and and or, it had instructions bis (bit set) and bic (bit clear). Both instructions take a data word x and a mask word m. They generate a result z consisting of the bits of x modified according to the bits of m. With bis, the modification involves setting z to 1 at each bit position where m is 1. With bic, the modification involves setting z to 0 at each bit position where m is 1. </p>
<p>To see how these operations relate to the C bit-level operations, assume we have functions bis and bic implementing the bit set and bit clear operations, and that we want to use these to implement functions computing bitwise operations | and ^, without using any other C operations. Fill in the missing code below. </p>
<p>Hint: Write C expressions for the operations bis and bic.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Declarations of functions implementing operations bis and bic */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> m)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bic</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> m)</span></span>;</span><br><span class="line"><span class="comment">/* Compute x|y using only calls to functions bis and bic */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bool_or</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> result = ;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Compute x^y using only calls to functions bis and bic */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bool_xor</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> result = ;</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="My-solution-white-check-mark-9"><a href="#My-solution-white-check-mark-9" class="headerlink" title="My solution : :white_check_mark:"></a>My solution : :white_check_mark:</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="comment">/* Declarations of functions implementing operations bis and bic */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> m)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bic</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> m)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Compute x|y using only calls to functions bis and bic */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bool_or</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> result = bis(x  , y);</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Compute x^y using only calls to functions bis and bic */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bool_xor</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> result = bis(bic(x, y) , bic(y, x));</span><br><span class="line"><span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">0</span> , b = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a|b test : %d\n&quot;</span> , (a|b) == bool_or(a, b) );</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a^b test : %d\n&quot;</span> , (a^b) == bool_xor(a, b) );</span><br><span class="line">    b = <span class="number">1</span>;                          </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a|b test : %d\n&quot;</span> , (a|b) == bool_or(a, b) );</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a^b test : %d\n&quot;</span> , (a^b) == bool_xor(a, b) );</span><br><span class="line">    a = <span class="number">1</span>;                          </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a|b test : %d\n&quot;</span> , (a|b) == bool_or(a, b) );</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a^b test : %d\n&quot;</span> , (a^b) == bool_xor(a, b) );</span><br><span class="line">    b = <span class="number">0</span>;                          </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a|b test : %d\n&quot;</span> , (a|b) == bool_or(a, b) );</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a^b test : %d\n&quot;</span> , (a^b) == bool_xor(a, b) );</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bis</span><span class="params">(<span class="keyword">int</span> x , <span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x | m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bic</span><span class="params">(<span class="keyword">int</span> x , <span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; ~m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a|b test : 1</span><br><span class="line">a^b test : 1</span><br><span class="line">a|b test : 1</span><br><span class="line">a^b test : 1</span><br><span class="line">a|b test : 1</span><br><span class="line">a^b test : 1</span><br><span class="line">a|b test : 1</span><br><span class="line">a^b test : 1</span><br></pre></td></tr></table></figure>
<p><span style="color:red">when doing boolean algebra, <strong>truth table</strong> and <strong>sum-of-product expression</strong> are very useful!!!</span></p>
<p><em>also , don’t forget xor property : <code>x ^ y = (x &amp; ~y) | (~x &amp; y)​</code></em></p>
<hr>
<h4 id="2-1-8-Logical-Operations-in-C"><a href="#2-1-8-Logical-Operations-in-C" class="headerlink" title="2.1.8 Logical Operations in C"></a>2.1.8 Logical Operations in C</h4><ul>
<li><em>The logical operations treat <strong>any nonzero argument as</strong> representing <strong>true</strong> and argument <strong>0 as representing false</strong></em></li>
<li> logical operators do not evaluate their second argument if the result of the expression can be determined by evaluating the first argument. Thus, for example, the expression <code>a &amp;&amp; 5/a</code> will never cause a division by zero, and the expression <code>p &amp;&amp; *p++</code> will never cause the dereferencing of a null pointer.</li>
</ul>
<hr>
<h4 id="Practice-Problem-2-14"><a href="#Practice-Problem-2-14" class="headerlink" title="Practice Problem 2.14"></a>Practice Problem 2.14</h4><blockquote>
<p>Suppose that a and b have byte values <code>0x55</code> and <code>0x46</code>, respectively. Fill in the following table indicating the byte values of the different C expressions:</p>
<table>
<thead>
<tr>
<th>Expression</th>
<th>Value</th>
</tr>
</thead>
<tbody><tr>
<td>a &amp; b</td>
<td></td>
</tr>
<tr>
<td>a | b</td>
<td></td>
</tr>
<tr>
<td>~a | ~b</td>
<td></td>
</tr>
<tr>
<td>a &amp; !b</td>
<td></td>
</tr>
<tr>
<td>a &amp;&amp; b</td>
<td></td>
</tr>
<tr>
<td>a || b</td>
<td></td>
</tr>
<tr>
<td>!a || !b</td>
<td></td>
</tr>
<tr>
<td>a &amp;&amp; ~b</td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-10"><a href="#My-solution-white-check-mark-10" class="headerlink" title="My solution : :white_check_mark:"></a>My solution : :white_check_mark:</h4><table>
<thead>
<tr>
<th>Expression</th>
<th>Value</th>
</tr>
</thead>
<tbody><tr>
<td>a &amp; b</td>
<td>0x44</td>
</tr>
<tr>
<td>a | b</td>
<td>0x57</td>
</tr>
<tr>
<td>~a | ~b</td>
<td>0xbb</td>
</tr>
<tr>
<td>a &amp; !b</td>
<td>0x00</td>
</tr>
<tr>
<td>a &amp;&amp; b</td>
<td>0x01</td>
</tr>
<tr>
<td>a || b</td>
<td>0x01</td>
</tr>
<tr>
<td>!a || !b</td>
<td>0x00</td>
</tr>
<tr>
<td>a &amp;&amp; ~b</td>
<td>0x01</td>
</tr>
</tbody></table>
<h4 id="Practice-Problem-2-15"><a href="#Practice-Problem-2-15" class="headerlink" title="Practice Problem 2.15"></a>Practice Problem 2.15</h4><blockquote>
<p>Using only bit-level and logical operations, write a C expression that is equivalent to <code>x == y</code>. In other words, it will return 1 when x and y are equal and 0 otherwise.</p>
</blockquote>
<h4 id="My-solution-1"><a href="#My-solution-1" class="headerlink" title="My solution :"></a>My solution :</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">equal</span><span class="params">(<span class="keyword">int</span> a , <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">bool</span>)(!(a ^ b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">3242542</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">3213434</span>;</span><br><span class="line">    <span class="keyword">int</span> c = a;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a == b test : %d %d\n&quot;</span> , a == b , equal(a, b));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a == c test : %d %d\n&quot;</span> , a == c , equal(a, c));</span><br><span class="line">    <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>There is <strong>NO</strong> real reason to use this expression rather than simply writing <code>x == y</code></em></p>
<hr>
<h3 id="2-1-9-Shift-Operations-in-C"><a href="#2-1-9-Shift-Operations-in-C" class="headerlink" title="2.1.9 Shift Operations in C"></a>2.1.9 Shift Operations in C</h3><h5 id="Left-shift"><a href="#Left-shift" class="headerlink" title="Left shift"></a>Left shift</h5><p>Left shift is simple and stable. </p>
<p>That is <code>x &lt;&lt; k</code> means x is shifted k bits to the left, dropping off the k most significant bits and filling the right end with k zeros.</p>
<h5 id="Right-shift"><a href="#Right-shift" class="headerlink" title="Right shift"></a>Right shift</h5><h6 id="Logical-Right-shift"><a href="#Logical-Right-shift" class="headerlink" title="Logical Right shift"></a>Logical Right shift</h6><p>A logical right shift fills the left end with k zeros, giving a result $[0,…, 0, x_{w−1}, x_{w−2},…,x_k].$</p>
<h6 id="Arithmetic-left-shift"><a href="#Arithmetic-left-shift" class="headerlink" title="Arithmetic left shift"></a>Arithmetic left shift</h6><p>An arithmetic right shift fills the left end with k repetitions of the most significant bit, giving a result$[x_{w−1},…,x_{w−1}, x_{w−1}, x_{w−2},…,x_k]$.</p>
<ul>
<li>In C, almost all compiler/machine combinations use <strong>arithmetic right shifts for signed data</strong>, and many programmers assume this to be the case. <strong>For unsigned data, on the other hand, right shifts must be logical.</strong></li>
<li> Java has a precise definition of how right shifts should be performed. The expression <code>x &gt;&gt; k</code> shifts x arithmetically by k positions, while <code>x &gt;&gt;&gt; k</code> shifts it logically</li>
</ul>
<hr>
<h4 id="Practice-Problem-2-16"><a href="#Practice-Problem-2-16" class="headerlink" title="Practice Problem 2.16"></a>Practice Problem 2.16</h4><blockquote>
<p>Fill in the table below showing the effects of the different shift operations on singlebyte quantities. The best way to think about shift operations is to work with binary representations. Convert the initial values to binary, perform the shifts, and then convert back to hexadecimal. Each of the answers should be 8 binary digits or 2 hexadecimal digits.</p>
<p><img src="/2021/06/10/CSAPP/Ch2/shift.png" alt="shift"></p>
</blockquote>
<h4 id="My-solution-white-check-mark-11"><a href="#My-solution-white-check-mark-11" class="headerlink" title="My solution:  :white_check_mark:"></a>My solution:  :white_check_mark:</h4><table>
<thead>
<tr>
<th>Hex</th>
<th>Binary</th>
<th>Binary</th>
<th>Hex</th>
<th>Binary</th>
<th>Hex</th>
<th>Binary</th>
<th>Hex</th>
</tr>
</thead>
<tbody><tr>
<td>0xd4</td>
<td>[11010100]</td>
<td>[01010000]</td>
<td>0x50</td>
<td>[00011010]</td>
<td>0x1a</td>
<td>[11111010]</td>
<td>0xfa</td>
</tr>
<tr>
<td>0x64</td>
<td>[01100100]</td>
<td>[10010000]</td>
<td>0x90</td>
<td>[00001100]</td>
<td>0x0c</td>
<td>[00001100]</td>
<td>0x0c</td>
</tr>
<tr>
<td>0x72</td>
<td>[01110010]</td>
<td>[11001000]</td>
<td>0xc8</td>
<td>[00001110]</td>
<td>0x0e</td>
<td>[00001110]</td>
<td>0x0e</td>
</tr>
<tr>
<td>0x44</td>
<td>[01000100]</td>
<td>[00010000]</td>
<td>0x10</td>
<td>[00001000]</td>
<td>0x08</td>
<td>[00001000]</td>
<td>0x08</td>
</tr>
</tbody></table>
<hr>
<p>What if shift length k is larger than the word width w?</p>
<ul>
<li>The C standards carefully avoid stating what should be done in such a case. On many machines, the shift amount is computed as $k \mod w$</li>
<li>Java, on the other hand, specifically requires that shift amounts should be computed in the modular fashion we have shown.</li>
</ul>
<p><strong>Programming tip : When in doubt about operator precedence, put in parentheses!</strong></p>
<h2 id="2-2-Integer-Representations"><a href="#2-2-Integer-Representations" class="headerlink" title="2.2 Integer Representations"></a>2.2 Integer Representations</h2><p><img src="/2021/06/10/CSAPP/Ch2/terminology.png" alt="terminology"></p>
<h3 id="2-2-1-Integral-Data-Types"><a href="#2-2-1-Integral-Data-Types" class="headerlink" title="2.2.1 Integral Data Types"></a>2.2.1 Integral Data Types</h3><p><img src="/2021/06/10/CSAPP/Ch2/range.png" alt="intergral range"></p>
<h3 id="2-2-2-Unsigned-Encodings"><a href="#2-2-2-Unsigned-Encodings" class="headerlink" title="2.2.2 Unsigned Encodings"></a>2.2.2 Unsigned Encodings</h3><p>The most common way you do with binary to interger.<br>$$<br>x_{w-1}…x_1x_0 = x_{w-1}\cdot2^{w-1}+…+x_1\cdot2^1+x_0\cdot 2^0<br>$$</p>
<blockquote>
<p>principle: <strong>Uniqueness</strong> of unsigned encoding</p>
<p>Function $B2U_w$ is a bijection.</p>
<p>The mathematical term bijection refers to a function f that goes two ways: it maps a value x to a value y where y = f (x), but it can also operate in reverse, since for every y, there is a unique value x such that f (x) = y.</p>
</blockquote>
<h3 id="2-2-3-Two’s-Complement-Encodings"><a href="#2-2-3-Two’s-Complement-Encodings" class="headerlink" title="2.2.3 Two’s-Complement Encodings"></a>2.2.3 Two’s-Complement Encodings</h3><p>The most common computer representation of signed numbers is known as two’s-complement form. This is defined by <strong>interpreting the most significant bit of the word to have negative weight.</strong> </p>
<ul>
<li><p>The most significant bit $x_{w−1}$ is also called the sign bit</p>
</li>
<li><p>Range of Two’s complement : $[100….00 , 011..11]$</p>
</li>
<li><p>the two’s-complement range is <strong>asymmetric</strong>: |TMin| = |TMax| + 1; that is, there is no positive counterpart to TMin. </p>
</li>
</ul>
<blockquote>
<p>principle: <strong>Uniqueness</strong> of two’s-complement encoding</p>
<p>Function $B2T_w$ is a bijection.</p>
</blockquote>
<hr>
<h4 id="Practice-Problem-2-17"><a href="#Practice-Problem-2-17" class="headerlink" title="Practice Problem 2.17"></a>Practice Problem 2.17</h4><blockquote>
<p>Assuming w = 4, we can assign a numeric value to each possible hexadecimal digit, assuming either an unsigned or a two’s-complement interpretation. Fill in the following table according to these interpretations by writing out the nonzero powers of 2 in the summations shown in Equations 2.1 and 2.3:</p>
<table>
<thead>
<tr>
<th>Hexadecimal</th>
<th>Binary</th>
<th>B2U</th>
<th>B2T</th>
</tr>
</thead>
<tbody><tr>
<td>0xa</td>
<td>[1010]</td>
<td>$2^3+2^1=10$</td>
<td>$-2^{3}+2^1=-6$</td>
</tr>
<tr>
<td>0x1</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0xb</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0x2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0x7</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0xc</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-12"><a href="#My-solution-white-check-mark-12" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><table>
<thead>
<tr>
<th>Hexadecimal</th>
<th>Binary</th>
<th>B2U</th>
<th>B2T</th>
</tr>
</thead>
<tbody><tr>
<td>0xa</td>
<td>[1010]</td>
<td>$2^3+2^1=10$</td>
<td>$-2^{3}+2^1=-6$</td>
</tr>
<tr>
<td>0x1</td>
<td>[0001]</td>
<td>$2^0=1$</td>
<td>$2^0=1$</td>
</tr>
<tr>
<td>0xb</td>
<td>[1011]</td>
<td>$2^3+2^1+2^0=11$</td>
<td>$-2^3+2^1+2^0=-5$</td>
</tr>
<tr>
<td>0x2</td>
<td>[0010]</td>
<td>$2^1=2$</td>
<td>$2^1=2$</td>
</tr>
<tr>
<td>0x7</td>
<td>[0111]</td>
<td>$2^2+2^1+2^0=7$</td>
<td>$2^2+2^1+2^0=7$</td>
</tr>
<tr>
<td>0xc</td>
<td>[1100]</td>
<td>$2^3+2^2=12$</td>
<td>$-2^3+2^2=-4$</td>
</tr>
</tbody></table>
<hr>
<blockquote>
<p>Programming tips:</p>
<ul>
<li><p>use <code>int32_t</code>, <code>uint64_t</code> ,…., to get exact size you want.</p>
</li>
<li><p>Formatted printing with fixed-width types requires use of macros that expand into format strings in a system-dependent manner. </p>
<p>So, for example, the values of variables x and y of type <code>int32_t</code> and <code>uint64_t</code> can be printed by the following call to printf: <code>printf(&quot;x = %&quot; PRId32 &quot;, y = %&quot; PRIu64 &quot;\n&quot;, x, y); </code></p>
<p>When compiled as a 64-bit program, macro PRId32 expands to the string “d”, while PRIu64 expands to the pair of strings “l” “u”. When the C preprocessor encounters a sequence of string constants separated only by spaces (or other whitespace characters), it concatenates them together. </p>
<p>Thus, the above call to printf becomes <code>printf(&quot;x = %d, y = %lu\n&quot;, x, y); </code>Using the macros ensures that a correct format string will be generated regardless of how the code is compiled.</p>
</li>
</ul>
</blockquote>
<p><img src="/2021/06/10/CSAPP/Ch2/importantnums.png" alt="important numbers"></p>
<ul>
<li><p>The C standards do NOT require signed integers to be represented in two’scomplement form, but nearly all machines do so.</p>
<p>So if you want max portability, do NOT assume any “typical” ranges beyond the minimum range and do NOT assume signed numbers are encoded by 2’s complement. Use <code>&lt;limit.h&gt;</code> which defines constants <code>INT_MAX</code>, <code>INT_ MIN</code>, and <code>UINT_MAX</code> describing the ranges of signed and unsigned integers.</p>
</li>
<li><p>The Java standard is quite specific about integer data type ranges and representations.These detailed requirements are intended to enable Java programs to behave identically regardless of the machines or operating systems running them.</p>
</li>
</ul>
<hr>
<h4 id="Practice-Problem-2-18"><a href="#Practice-Problem-2-18" class="headerlink" title="Practice Problem 2.18"></a>Practice Problem 2.18</h4><blockquote>
<p>In Chapter 3, we will look at listings generated by a disassembler, a program that converts an executable program file back to a more readable ASCII form. </p>
<p>These files contain many hexadecimal numbers, typically representing values in two’scomplement form. Being able to recognize these numbers and understand their significance (for example, whether they are negative or positive) is an important skill. </p>
<p>For the lines labeled A–I (on the right) in the following listing, convert the hexadecimal values (in 32-bit two’s-complement form) shown to the right of the instruction names (sub, mov, and add) into their decimal equivalents:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">4004d0: 48 81 ec e0 02 00 00 	sub $0x2e0,%rsp 			A.</span><br><span class="line">4004d7: 48 8b 44 24 a8 			mov -0x58(%rsp),%rax 		B.</span><br><span class="line">4004dc: 48 03 47 28 			add 0x28(%rdi),%rax 		C.</span><br><span class="line">4004e0: 48 89 44 24 d0 			mov %rax,-0x30(%rsp) 		D.</span><br><span class="line">4004e5: 48 8b 44 24 78 			mov 0x78(%rsp),%rax 		E.</span><br><span class="line">4004ea: 48 89 87 88 00 00 00 	mov %rax,0x88(%rdi) 		F.</span><br><span class="line">4004f1: 48 8b 84 24 f8 01 00 	mov 0x1f8(%rsp),%rax 		G.</span><br><span class="line">4004f8: 00</span><br><span class="line">4004f9: 48 03 44 24 08 			add 0x8(%rsp),%rax</span><br><span class="line">4004fe: 48 89 84 24 c0 00 00 	mov %rax,0xc0(%rsp) 		H.</span><br><span class="line">400505: 00</span><br><span class="line">400506: 48 8b 44 d4 b8 			mov -0x48(%rsp,%rdx,8),%rax I.</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="My-solution-white-check-mark-13"><a href="#My-solution-white-check-mark-13" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><table>
<thead>
<tr>
<th>Index</th>
<th>hexadecimal</th>
<th>decimal</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>0x2e0</td>
<td>736</td>
</tr>
<tr>
<td>B</td>
<td>-0x58</td>
<td>-88</td>
</tr>
<tr>
<td>C</td>
<td>0x28</td>
<td>40</td>
</tr>
<tr>
<td>D</td>
<td>-0x30</td>
<td>-48</td>
</tr>
<tr>
<td>E</td>
<td>0x78</td>
<td>120</td>
</tr>
<tr>
<td>F</td>
<td>0x88</td>
<td>136</td>
</tr>
<tr>
<td>G</td>
<td>0x1f8</td>
<td>504</td>
</tr>
<tr>
<td>H</td>
<td>0xc0</td>
<td>192</td>
</tr>
<tr>
<td>I</td>
<td>-0x48</td>
<td>-72</td>
</tr>
</tbody></table>
<hr>
<h3 id="2-2-4-Conversions-between-Signed-and-Unsigned"><a href="#2-2-4-Conversions-between-Signed-and-Unsigned" class="headerlink" title="2.2.4 Conversions between Signed and Unsigned"></a>2.2.4 Conversions between Signed and Unsigned</h3><p><strong><em>the effect of casting is to keep the bit values identical but change how these bits are interpreted.</em></strong></p>
<hr>
<h4 id="Practice-Problem-2-19"><a href="#Practice-Problem-2-19" class="headerlink" title="Practice Problem 2.19"></a>Practice Problem 2.19</h4><blockquote>
<p>Using the table you filled in when solving Problem 2.17, fill in the following table describing the function $T2U_4$:</p>
<table>
<thead>
<tr>
<th>x</th>
<th>$T2U_4(x)$</th>
</tr>
</thead>
<tbody><tr>
<td>-1</td>
<td></td>
</tr>
<tr>
<td>-5</td>
<td></td>
</tr>
<tr>
<td>-6</td>
<td></td>
</tr>
<tr>
<td>-4</td>
<td></td>
</tr>
<tr>
<td>1</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-14"><a href="#My-solution-white-check-mark-14" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><table>
<thead>
<tr>
<th>x</th>
<th>$T2U_4(x)$</th>
</tr>
</thead>
<tbody><tr>
<td>-1</td>
<td>15</td>
</tr>
<tr>
<td>-5</td>
<td>11</td>
</tr>
<tr>
<td>-6</td>
<td>10</td>
</tr>
<tr>
<td>-4</td>
<td>12</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td>?</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bitstring.CreationError: <span class="number">8</span> <span class="keyword">is</span> too large a signed integer <span class="keyword">for</span> a bitstring of length <span class="number">4.</span> The</span><br><span class="line"> allowed <span class="built_in">range</span> <span class="keyword">is</span> [-<span class="number">8</span>, <span class="number">7</span>].</span><br></pre></td></tr></table></figure>
<hr>
<p><strong><em>when mapping a signed number to its unsigned counterpart, negative numbers are converted to large positive numbers, while nonnegative numbers remain unchanged.</em></strong></p>
<blockquote>
<p>principle: Conversion from two’s complement to unsigned<br>$$<br>\forall x , TMin\le x \le TMax,T2U_w(x) = \begin{cases}<br>x,&amp;x\ge0\<br>x+2^w,&amp;x&lt;0<br>\end{cases}<br>$$<br>Derivation:<br>$$<br>B2U_w(\vec{x}) - B2T_w(\vec{x}) = x_{w-1}\cdot2^{w-1}-(-x_{w-1}\cdot2^{w-1}) = x_{w-1}\cdot 2^w<br>$$</p>
<p>$$<br>T2U_w(x) = B2U_w(T2B_w(x))=x+x_{w-1}\cdot 2^w<br>$$</p>
</blockquote>
<hr>
<h4 id="Practice-Problem-2-20"><a href="#Practice-Problem-2-20" class="headerlink" title="Practice Problem 2.20"></a>Practice Problem 2.20</h4><blockquote>
<p>Explain how Equation 2.5 applies to the entries in the table you generated when solving Problem 2.19.</p>
</blockquote>
<h4 id="My-solution-white-check-mark-15"><a href="#My-solution-white-check-mark-15" class="headerlink" title="My solution : :white_check_mark:"></a>My solution : :white_check_mark:</h4><p>if the value is nonnegative, leave it unchanged, otherwise add it with $2^4=16$</p>
<hr>
<p>Going in the other direction:</p>
<blockquote>
<p>principle: Unsigned to two’s-complement conversion<br>$$<br>\forall u , 0\le u \le UMax,U2T_w(u) = \begin{cases}<br>u , &amp; u\le TMax\<br>u - 2^{w} , &amp; u &gt; TMax<br>\end{cases}<br>$$</p>
</blockquote>
<p>Summary:</p>
<ul>
<li>Numbers in this range have identical unsigned and two’s-complement representations. </li>
<li>For values outside of this range, the conversions either add or subtract $2^w$</li>
</ul>
<h3 id="2-2-5-Signed-versus-Unsigned-in-C"><a href="#2-2-5-Signed-versus-Unsigned-in-C" class="headerlink" title="2.2.5 Signed versus Unsigned in C"></a>2.2.5 Signed versus Unsigned in C</h3><p><strong><em>When an operation is performed where one operand is signed and the other is unsigned, C implicitly <u>casts the signed argument to unsigned</u> and performs the operations assuming the numbers are nonnegative.</em></strong></p>
<p><img src="/2021/06/10/CSAPP/Ch2/versus.png" alt="versus"></p>
<h4 id="Practice-Problem-2-21"><a href="#Practice-Problem-2-21" class="headerlink" title="Practice Problem 2.21"></a>Practice Problem 2.21</h4><blockquote>
<p>Assuming the expressions are evaluated when executing a 32-bit program on a machine that uses two’s-complement arithmetic, fill in the following table describing the effect of casting and relational operations, in the style of Figure 2.19:</p>
<table>
<thead>
<tr>
<th>Expression</th>
<th>Type</th>
<th>Evaluation</th>
</tr>
</thead>
<tbody><tr>
<td>-2147483647-1 == 2147483648U</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-2147483647-1 &lt; 2147483647</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-2147483647-1U &lt; 2147483647</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-2147483647-1 &lt; -2147483647</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-2147483647-1U &lt; -2147483647</td>
<td></td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-16"><a href="#My-solution-white-check-mark-16" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><table>
<thead>
<tr>
<th>Expression</th>
<th>Type</th>
<th>Evaluation</th>
</tr>
</thead>
<tbody><tr>
<td>-2147483647-1 == 2147483648U</td>
<td>Unsigned</td>
<td>1</td>
</tr>
<tr>
<td>-2147483647-1 &lt; 2147483647</td>
<td>Signed</td>
<td>1</td>
</tr>
<tr>
<td>-2147483647-1U &lt; 2147483647</td>
<td>Unsigned</td>
<td>0</td>
</tr>
<tr>
<td>-2147483647-1 &lt; -2147483647</td>
<td>Signed</td>
<td>1</td>
</tr>
<tr>
<td>-2147483647-1U &lt; -2147483647</td>
<td>Unsigned</td>
<td>1</td>
</tr>
</tbody></table>
<h3 id="2-2-6-Expanding-the-Bit-Representation-of-a-Number"><a href="#2-2-6-Expanding-the-Bit-Representation-of-a-Number" class="headerlink" title="2.2.6 Expanding the Bit Representation of a Number"></a>2.2.6 Expanding the Bit Representation of a Number</h3><p>One common operation is to <strong>convert between integers having different word sizes</strong> while retaining the same numeric value. </p>
<ul>
<li> When the destination data type is too small to represent the desired value, this may not be possible.</li>
<li>Converting from a smaller to a larger data type, however, should always be possible.</li>
</ul>
<h5 id="Convert-an-unsigned-number-to-a-larger-data-type"><a href="#Convert-an-unsigned-number-to-a-larger-data-type" class="headerlink" title="Convert an unsigned number to a larger data type:"></a>Convert an unsigned number to a larger data type:</h5><ul>
<li>simply add leading zeros to the representation</li>
<li>this operation is known as zero extension</li>
</ul>
<h5 id="Convert-a-two’s-complement-number-to-a-larger-data-type"><a href="#Convert-a-two’s-complement-number-to-a-larger-data-type" class="headerlink" title="Convert a two’s-complement number to a larger data type:"></a>Convert a two’s-complement number to a larger data type:</h5><ul>
<li>adding copies of the most significant bit to the representation</li>
<li>this operation is known as sign extension</li>
</ul>
<h5 id="Why-sign-extension-pad-1-How-this-perseves-the-value"><a href="#Why-sign-extension-pad-1-How-this-perseves-the-value" class="headerlink" title="Why sign extension pad 1 ? How this perseves the value ?"></a>Why sign extension pad 1 ? How this perseves the value ?</h5><blockquote>
<p>Derivation:</p>
<p>assume we expend by k bits<br>$$<br>\forall k \in Z^*,w’=w+k<br>$$<br>we only need to prove when k=1 the value holds, then all the situations are the same.<br>$$<br>B2T_{w+1}([x_{w−1}, x_{w−1}, x_{w−2},…,x_0]) = -x_{w−1}2^{w}+x_{w−1}2^{w-1}+…+x_02^0\<br>=-x_{w−1}2^{w-1}+…+x_0\<br>=B2T_{w}([ x_{w−1}, x_{w−2},…,x_0])<br>$$<br>The key property we exploit is that $2^w − 2^{w−1} = 2^{w−1}$</p>
</blockquote>
<hr>
<h4 id="Practice-Problem-2-22"><a href="#Practice-Problem-2-22" class="headerlink" title="Practice Problem 2.22"></a>Practice Problem 2.22</h4><blockquote>
<p>Show that each of the following bit vectors is a two’s-complement representation of −4 by applying Equation 2.3: </p>
<p>A. [1100] </p>
<p>B. [11100] </p>
<p>C. [111100] </p>
<p>Observe that the second and third bit vectors can be derived from the first by sign extension</p>
</blockquote>
<h4 id="My-solution-white-check-mark-17"><a href="#My-solution-white-check-mark-17" class="headerlink" title="My solution : :white_check_mark:"></a>My solution : :white_check_mark:</h4><p>A : $-2^3+2^2=-4$</p>
<p>B : $-2^4+2^3+2^2=-4$</p>
<p>C : $-2^5+2^4+2^3+2^2=-4$</p>
<hr>
<p><strong><em>When converting from <code>short</code> to <code>unsigned</code>, the program first changes the size and then the type. This convention is required by the C standards.</em></strong></p>
<hr>
<h4 id="Practice-Problem-2-23"><a href="#Practice-Problem-2-23" class="headerlink" title="Practice Problem 2.23"></a>Practice Problem 2.23</h4><blockquote>
<p>Consider the following C functions:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun1</span><span class="params">(<span class="keyword">unsigned</span> word)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">int</span>) ((word &lt;&lt; <span class="number">24</span>) &gt;&gt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun2</span><span class="params">(<span class="keyword">unsigned</span> word)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> ((<span class="keyword">int</span>) word &lt;&lt; <span class="number">24</span>) &gt;&gt; <span class="number">24</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Assume these are executed as a 32-bit program on a machine that uses two’scomplement arithmetic. Assume also that right shifts of signed values are performed arithmetically, while right shifts of unsigned values are performed logically.</p>
<p>A. Fill in the following table showing the effect of these functions for several example arguments. You will find it more convenient to work with a hexadecimal representation. Just remember that hex digits 8 through F have their most significant bits equal to 1.</p>
<table>
<thead>
<tr>
<th>w</th>
<th>fun1(w)</th>
<th>fun2(2)</th>
</tr>
</thead>
<tbody><tr>
<td>0x00000076</td>
<td></td>
<td></td>
</tr>
<tr>
<td>0x87654321</td>
<td></td>
<td></td>
</tr>
<tr>
<td>0x000000C9</td>
<td></td>
<td></td>
</tr>
<tr>
<td>0xEDCBA987</td>
<td></td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-18"><a href="#My-solution-white-check-mark-18" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><table>
<thead>
<tr>
<th>w</th>
<th>fun1(w)</th>
<th>fun2(2)</th>
</tr>
</thead>
<tbody><tr>
<td>0x00000076</td>
<td>0x00000076</td>
<td>0x00000076</td>
</tr>
<tr>
<td>0x87654321</td>
<td>0x00000021</td>
<td>0x00000021</td>
</tr>
<tr>
<td>0x000000C9</td>
<td>0x000000C9</td>
<td>0xFFFFFFC9</td>
</tr>
<tr>
<td>0xEDCBA987</td>
<td>0x00000087</td>
<td>0xFFFFFF87</td>
</tr>
</tbody></table>
<hr>
<h3 id="2-2-7-Truncating-Numbers"><a href="#2-2-7-Truncating-Numbers" class="headerlink" title="2.2.7 Truncating Numbers"></a>2.2.7 Truncating Numbers</h3><h5 id="Truncate-unsigned-number"><a href="#Truncate-unsigned-number" class="headerlink" title="Truncate unsigned number"></a>Truncate unsigned number</h5><blockquote>
<p>principle: Truncation of an unsigned number </p>
<p>Let x be the bit vector $[x_{w−1}, x_{w−2},…,x_0]$, and let $x’$ be the result of truncating it to k bits: $x’ = [x_{k−1}, x_{k−2},…,x_0]$. Let $x = B2U_w(\vec{x})$ and $x’ = B2U_k(\vec{x’})$. </p>
<p>Then $x’ = x \mod 2^k$.</p>
</blockquote>
<p>The intuition behind this principle is simply that all of the bits that were truncated have weights of the form $2^i$ , where i ≥ k, and therefore each of these weights reduces to zero under the modulus operation.</p>
<h5 id="Truncate-signed-number"><a href="#Truncate-signed-number" class="headerlink" title="Truncate signed number"></a>Truncate signed number</h5><blockquote>
<p>principle: Truncation of a two’s-complement number </p>
<p>Let x be the bit vector $[x_{w−1}, x_{w−2},…,x_0]$, and let  $x’$ be the result of truncating it to k bits: $x’ = [x_{k−1}, x_{k−2},…,x_0]$. Let $x = B2T_w(\vec{x})$ and $x’ = B2T_k(\vec{x’})$. </p>
<p>Then $x’ = U2T_k(x \mod 2^k)$.</p>
</blockquote>
<h4 id="Practice-Problem-2-24"><a href="#Practice-Problem-2-24" class="headerlink" title="Practice Problem 2.24"></a>Practice Problem 2.24</h4><blockquote>
<p>Suppose we truncate a 4-bit value (represented by hex digits 0 through F) to a 3- bit value (represented as hex digits 0 through 7.) Fill in the table below showing the effect of this truncation for some cases, in terms of the unsigned and two’scomplement interpretations of those bit patterns</p>
<p>Unsigned:</p>
<table>
<thead>
<tr>
<th>Original</th>
<th>Truncated</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td></td>
</tr>
<tr>
<td>12</td>
<td></td>
</tr>
<tr>
<td>14</td>
<td></td>
</tr>
</tbody></table>
<p>Two’s complement:</p>
<table>
<thead>
<tr>
<th>Original</th>
<th>Truncated</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td></td>
</tr>
<tr>
<td>5</td>
<td></td>
</tr>
<tr>
<td>-4</td>
<td></td>
</tr>
<tr>
<td>-2</td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<h4 id="My-solution-white-check-mark-19"><a href="#My-solution-white-check-mark-19" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>Unsigned:</p>
<table>
<thead>
<tr>
<th>Original</th>
<th>Truncated</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>12</td>
<td>4</td>
</tr>
<tr>
<td>14</td>
<td>6</td>
</tr>
</tbody></table>
<p>Two’s complement:</p>
<table>
<thead>
<tr>
<th>Original</th>
<th>Truncated</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>-3</td>
</tr>
<tr>
<td>-4</td>
<td>-4</td>
</tr>
<tr>
<td>-2</td>
<td>-2</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ls = [<span class="number">5</span> , -<span class="number">4</span> , -<span class="number">2</span>]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> ls:</span><br><span class="line">    a = ba(<span class="built_in">int</span>=x,length=<span class="number">4</span>)</span><br><span class="line">    truncateda = ba(<span class="built_in">bin</span>=a.<span class="built_in">bin</span>[<span class="number">1</span>:])</span><br><span class="line">    print(<span class="string">&quot;original:&quot;</span> , a.<span class="built_in">int</span>, <span class="string">&quot;after:&quot;</span> , truncateda.<span class="built_in">int</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">original: 5 after: -3</span><br><span class="line">original: -4 after: -4</span><br><span class="line">original: -2 after: -2</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="2-2-8-Advice-on-Signed-versus-Unsigned"><a href="#2-2-8-Advice-on-Signed-versus-Unsigned" class="headerlink" title="2.2.8 Advice on Signed versus Unsigned"></a>2.2.8 Advice on Signed versus Unsigned</h3><p><strong><em>Since the casting takes place without any clear indication in the code, programmers often overlook its effects.Be careful!</em></strong></p>
<h4 id="Practice-Problem-2-25"><a href="#Practice-Problem-2-25" class="headerlink" title="Practice Problem 2.25"></a>Practice Problem 2.25</h4><blockquote>
<p>Consider the following code that attempts to sum the elements of an array <code>a</code>, where the number of elements is given by parameter length:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* WARNING: This is buggy code */</span>    </span><br><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">sum_elements</span><span class="params">(<span class="keyword">float</span> a[], <span class="keyword">unsigned</span> length)</span> </span>&#123;      </span><br><span class="line">    <span class="keyword">int</span> i;                  </span><br><span class="line">	<span class="keyword">float</span> result = <span class="number">0</span>;       </span><br><span class="line">                        </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= length<span class="number">-1</span>; i++)      </span><br><span class="line">	result += a[i];         </span><br><span class="line">	<span class="keyword">return</span> result;          </span><br><span class="line">&#125;        </span><br></pre></td></tr></table></figure>

<p>When run with argument length equal to 0, this code should return 0.0. Instead, it encounters a memory error. Explain why this happens. Show how this code can be corrected.</p>
</blockquote>
<h4 id="My-solution-white-check-mark-20"><a href="#My-solution-white-check-mark-20" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p><code>length</code> is an unsigned number, while <code>i</code> is a signed one. When evaluate <code>i&lt;= length-1</code> , <code>i</code> will be converted to <code>unsigned</code>.</p>
<p>When <code>length</code> equals 0, <code>length-1</code> gives the bit string <code>0b111111....111</code>, then any value in <code>unsigned</code> is less than <code>length-1</code> </p>
<ul>
<li><p>the comparison always holds</p>
</li>
<li><p>expression <code>a[i]</code> will access a forbidden memory area.</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">float</span> <span class="title">sum_elements</span><span class="params">(<span class="keyword">float</span> a[], <span class="keyword">unsigned</span> length)</span> </span>&#123;      </span><br><span class="line">    <span class="keyword">unsigned</span> i;                  </span><br><span class="line">	<span class="keyword">float</span> result = <span class="number">0</span>;       </span><br><span class="line">                        </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++)      </span><br><span class="line">	result += a[i];         </span><br><span class="line">	<span class="keyword">return</span> result;          </span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
<h4 id="Practice-Problem-2-26"><a href="#Practice-Problem-2-26" class="headerlink" title="Practice Problem 2.26"></a>Practice Problem 2.26</h4><blockquote>
<p>You are given the assignment of writing a function that determines whether one string is longer than another. You decide to make use of the string library function <code>strlen</code> having the following declaration:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Prototype for library function strlen */</span></span><br><span class="line"><span class="function"><span class="keyword">size_t</span> <span class="title">strlen</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span></span>;</span><br></pre></td></tr></table></figure>

<p>Here is your first attempt at the function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Determine whether string s is longer than string t */</span></span><br><span class="line"><span class="comment">/* WARNING: This function is buggy */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strlonger</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">char</span> *t)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">strlen</span>(s) - <span class="built_in">strlen</span>(t) &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When you test this on some sample data, things do not seem to work quite right. You investigate further and determine that, when compiled as a 32-bit program, data type <code>size_t</code> is defined (via<code>typedef</code>) in header file <code>stdio.h</code> to be <code>unsigned</code>.</p>
<p>A. For what cases will this function produce an incorrect result? </p>
<p>B. Explain how this incorrect result comes about. </p>
<p>C. Show how to fix the code so that it will work reliably.</p>
</blockquote>
<h4 id="My-solution-white-check-mark-21"><a href="#My-solution-white-check-mark-21" class="headerlink" title="My solution: :white_check_mark:"></a>My solution: :white_check_mark:</h4><p>A : if string s doesn’t have the same length with string t, the result will always be true</p>
<p>B : when compare <code>unsigned</code> with <code>0</code>, the result will always be true</p>
<p>C:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strlonger</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">char</span> *t)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">strlen</span>(s) &gt; <span class="built_in">strlen</span>(t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>We have seen multiple ways in which the subtle features of unsigned arithmetic, and especially the implicit conversion of signed to unsigned, can lead to errors or vulnerabilities.</p>
<ul>
<li>One way to avoid such bugs is to never use unsigned numbers. (In fact, few languages other than C support unsigned integers.)</li>
<li>Unsigned values are very useful when we want to think of words as just collections of bits with no numeric interpretation.<ul>
<li>when packing a word with flags describing various Boolean conditions.</li>
<li>Addresses are naturally unsigned, so systems programmers find unsigned types to be helpful.</li>
<li>Unsigned values are also useful when implementing mathematical packages for modular arithmetic and for multiprecision arithmetic, in which numbers are represented by arrays of words.</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://rubbish-and-world.github.io/2021/06/10/CSAPP/Ch2/" data-id="clw33pwyg000qrtyq6cbtaaff" data-title="Ch2" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/07/12/miscellaneous/PyFAQ/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          PyFAQ
        
      </div>
    </a>
  
  
    <a href="/2021/06/10/CSAPP/Introduction/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Introduction</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Cryptography/">Cryptography</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure/">Data Structure</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Electronics/">Electronics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/FrontEnd/">FrontEnd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/FrontEnd/course/">course</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IOT/">IOT</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LLL/">LLL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine Learning</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/NTU/">NTU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/Stanford-CS229/">Stanford CS229</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Math/Discrete-Mathematics/">Discrete Mathematics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/Linear-Algebra/">Linear Algebra</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/Statistics/">Statistics</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Missing-Semester/">Missing Semester</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Networking/">Networking</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Networking/Stanford-CS144/">Stanford CS144</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/">OS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/OS/30DayOS/">30DayOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/TEP/">TEP</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python-OG/">Python OG</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web3/">Web3</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/bis/">bis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/csapp/">csapp</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/feeling/">feeling</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/feelings/">feelings</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/noval/">noval</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/" rel="tag">game</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/game/" style="font-size: 10px;">game</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/05/19/feelings/flow/">flow</a>
          </li>
        
          <li>
            <a href="/2024/05/17/feelings/crush/">crush</a>
          </li>
        
          <li>
            <a href="/2024/02/04/Bis/Core/">Core</a>
          </li>
        
          <li>
            <a href="/2024/01/29/miscellaneous/steal-video/">steal-video</a>
          </li>
        
          <li>
            <a href="/2024/01/01/feelings/2024/">2024</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 rubbish<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>