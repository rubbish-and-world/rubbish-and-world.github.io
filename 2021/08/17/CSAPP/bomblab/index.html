<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>bomblab | rubbishbin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Bomb labLet’s do reverse engineering (Unfortunately, we cannot get CMU version bomb … We won’t lose points when the bomb blows up.)">
<meta property="og:type" content="article">
<meta property="og:title" content="bomblab">
<meta property="og:url" content="http://rubbish-and-world.github.io/2021/08/17/CSAPP/bomblab/index.html">
<meta property="og:site_name" content="rubbishbin">
<meta property="og:description" content="Bomb labLet’s do reverse engineering (Unfortunately, we cannot get CMU version bomb … We won’t lose points when the bomb blows up.)">
<meta property="og:locale">
<meta property="article:published_time" content="2021-08-17T12:44:29.000Z">
<meta property="article:modified_time" content="2021-08-20T04:38:39.002Z">
<meta property="article:author" content="rubbish">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="rubbishbin" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">rubbishbin</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://rubbish-and-world.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-CSAPP/bomblab" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/17/CSAPP/bomblab/" class="article-date">
  <time class="dt-published" datetime="2021-08-17T12:44:29.000Z" itemprop="datePublished">2021-08-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/csapp/">csapp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      bomblab
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Bomb-lab"><a href="#Bomb-lab" class="headerlink" title="Bomb lab"></a>Bomb lab</h2><p><em>Let’s do reverse engineering</em></p>
<p>(Unfortunately, we cannot get CMU version bomb … We won’t lose points when the bomb blows up.)</p>
<a id="more"></a>

<h3 id="Bomb-lab-how-to"><a href="#Bomb-lab-how-to" class="headerlink" title="Bomb lab how to"></a>Bomb lab how to</h3><ul>
<li>read the writeup</li>
<li>You get three files<ul>
<li>the README</li>
<li>the executable</li>
<li>the source file (<strong>Heavily redacted, you need to use <code>gdb</code> to figure out the acutal code</strong>)</li>
</ul>
</li>
</ul>
<h3 id="Useful-utilities"><a href="#Useful-utilities" class="headerlink" title="Useful utilities"></a>Useful utilities</h3><ul>
<li><code>objdump</code><ul>
<li><code>-d</code> for disassembly</li>
<li><code>-t</code> for print the symbol table entries of the file</li>
</ul>
</li>
<li><code>strings</code> to extract all printable strings</li>
<li><code>gdb</code> to do the main job</li>
<li><code>man</code> to get the help you need</li>
<li><code>readelf</code> to get read-only data section</li>
</ul>
<p>(also <code>IDA</code>, <code>Ghidra</code>, <code>radare2</code>  and other reverse engineering tools, but you will lose your precious hand-on experience for reconstruct c code from assembly, not recommended.)</p>
<h3 id="Get-started"><a href="#Get-started" class="headerlink" title="Get started"></a>Get started</h3><h4 id="Gather-information"><a href="#Gather-information" class="headerlink" title="Gather information"></a>Gather information</h4><ul>
<li><p>There are 6 phases in the bomb</p>
</li>
<li><p>The bomb use <code>sscanf</code> to get input</p>
</li>
<li><p>The bomb can accept a command line argument and treat it as input, end with EOF and then switch to <code>stdin</code>. So we can faciliate this feature to easy our pain of retyping.(Thank you Dr. Evil :crying_cat_face: )</p>
</li>
<li><p>Although <code>objdump -d</code> gives you a lot of information, it doesn’t tell you the whole story.</p>
<p>For example</p>
<p> a call to <code>sscanf</code> might appear as: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8048c36: e8 99 fc ff ff call 80488d4 &lt;_init+0x1a0&gt;</span><br></pre></td></tr></table></figure>
<p>while in <code>gdb</code> this is</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x000000000000075e &lt;+68&gt;:	callq  0x5f0 &lt;__isoc99_sscanf@plt&gt;</span><br></pre></td></tr></table></figure>
<p>(but I got the same result in <code>objdump</code> )</p>
</li>
<li><p><code>strings bomb</code></p>
<ul>
<li><p>It seems that there will be a secret stage : <code>Wow! You&#39;ve defused the secret stage!</code></p>
</li>
<li><p><code>ctrl-c</code> don’t work : <code>So you think you can stop the bomb with ctrl-c, do you?</code></p>
<p>(Laterly it turned out that <code>ctrl-c</code> does not get banned: <code>Well...OK. :-)</code> )</p>
</li>
<li><p>It still try to connet to the server ? Let’s check the code to figure this out.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">greatwhite.ics.cs.cmu.edu</span><br><span class="line">angelshark.ics.cs.cmu.edu</span><br><span class="line">makoshark.ics.cs.cmu.edu</span><br><span class="line">Error: HTTP request failed with error %d: %s</span><br><span class="line">GET &#x2F;%s&#x2F;submitr.pl&#x2F;?userid&#x3D;%s&amp;lab&#x3D;%s&amp;result&#x3D;%s&amp;submit&#x3D;submit HTTP&#x2F;1.0</span><br><span class="line">Error: Unable to connect to server %s</span><br></pre></td></tr></table></figure></li>
<li><p>compile options</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GNU C 4.8.1 -mtune=generic -march=x86-64 -ggdb -O1 -fstack-protector</span><br></pre></td></tr></table></figure>
<p>(canary found)</p>
</li>
</ul>
</li>
<li><p><code>less bomb.c</code></p>
<ul>
<li>phase 4 has something to do with math</li>
<li>phase 5 play with memory</li>
<li>there must be a secret stage</li>
</ul>
</li>
<li><p><code>objdump -t bomb</code></p>
<p>Potential useful symbols</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">num_input_strings</span><br><span class="line">explode_bomb</span><br><span class="line">fun7</span><br><span class="line">func4</span><br><span class="line">string_length</span><br><span class="line">secret_phase</span><br><span class="line">strings_not_equal</span><br><span class="line">read_six_numbers</span><br></pre></td></tr></table></figure>
<h4 id="Static-analysis"><a href="#Static-analysis" class="headerlink" title="Static analysis"></a>Static analysis</h4></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ objdump -d bomb &gt; codedump.s</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>main</code> has the same code shown by <code>bomb.c</code></p>
</li>
<li><p><code>num_input_strings</code> is called by <code>read_line</code></p>
</li>
<li><p>Function <code>submitr</code> try to connect to the server, but it can only be called by <code>driver_post</code>, and <code>driver_post</code> doesn’t called by any function. So the bomb won’t connect to CMU’s server when it explode.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ readelf -x .rodata bomb</span><br><span class="line">$ readelf -p .rodata bomb</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">000000000040143a &lt;explode_bomb&gt;:</span><br><span class="line"> 40143a:       48 83 ec 08             sub    $0x8,%rsp</span><br><span class="line"> 40143e:       bf a3 25 40 00          mov    $0x4025a3,%edi</span><br><span class="line"> 401443:       e8 c8 f6 ff ff          callq  400b10 &lt;puts@plt&gt;</span><br><span class="line"> 401448:       bf ac 25 40 00          mov    $0x4025ac,%edi</span><br><span class="line"> 40144d:       e8 be f6 ff ff          callq  400b10 &lt;puts@plt&gt;</span><br><span class="line"> 401452:       bf 08 00 00 00          mov    $0x8,%edi</span><br><span class="line"> 401457:       e8 c4 f7 ff ff          callq  400c20 &lt;exit@plt&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">explode_bomb</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;BOOM!!!&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;The bomb has blown up.&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//no call to submitr() and driver_post()</span></span><br></pre></td></tr></table></figure></li>
<li><p>Phase 1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0000000000400ee0 &lt;phase_1&gt;:    </span><br><span class="line">400ee0:       48 83 ec 08             sub    $0x8,%rsp           </span><br><span class="line">400ee4:       be 00 24 40 00          mov    $0x402400,%esi           </span><br><span class="line">400ee9:       e8 4a 04 00 00          callq  401338 &lt;strings_not_equal&gt;           </span><br><span class="line">400eee:       85 c0                   test   %eax,%eax           </span><br><span class="line">400ef0:       74 05                   je     400ef7 &lt;phase_1+0x17&gt;           </span><br><span class="line">400ef2:       e8 43 05 00 00          callq  40143a &lt;explode_bomb&gt;           </span><br><span class="line">400ef7:       48 83 c4 08             add    $0x8,%rsp           </span><br><span class="line">400efb:       c3                      retq</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phase_1</span><span class="params">(<span class="keyword">char</span>* input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> esi = <span class="number">0x402400</span>;</span><br><span class="line">    <span class="comment">//address at section .rodata</span></span><br><span class="line">    <span class="comment">//Border relations with Canada have never been better.</span></span><br><span class="line">    <span class="keyword">int</span> eax = strings_not_equal(input , (<span class="keyword">char</span>*)esi);</span><br><span class="line">    <span class="keyword">if</span> (eax != <span class="number">0</span>) explode_bomb();</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">0000000000401338 &lt;strings_not_equal&gt;:</span><br><span class="line">  401338:	41 54                	push   %r12</span><br><span class="line">  40133a:	55                   	push   %rbp</span><br><span class="line">  40133b:	53                   	push   %rbx</span><br><span class="line">  40133c:	48 89 fb             	mov    %rdi,%rbx</span><br><span class="line">  40133f:	48 89 f5             	mov    %rsi,%rbp</span><br><span class="line">  401342:	e8 d4 ff ff ff       	callq  40131b &lt;string_length&gt;</span><br><span class="line">  401347:	41 89 c4             	mov    %eax,%r12d</span><br><span class="line">  40134a:	48 89 ef             	mov    %rbp,%rdi</span><br><span class="line">  40134d:	e8 c9 ff ff ff       	callq  40131b &lt;string_length&gt;</span><br><span class="line">  401352:	ba 01 00 00 00       	mov    $0x1,%edx</span><br><span class="line">  401357:	41 39 c4             	cmp    %eax,%r12d</span><br><span class="line">  40135a:	75 3f                	jne    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  40135c:	0f b6 03             	movzbl (%rbx),%eax</span><br><span class="line">  40135f:	84 c0                	test   %al,%al</span><br><span class="line">  401361:	74 25                	je     401388 &lt;strings_not_equal+0x50&gt;</span><br><span class="line">  401363:	3a 45 00             	cmp    0x0(%rbp),%al</span><br><span class="line">  401366:	74 0a                	je     401372 &lt;strings_not_equal+0x3a&gt;</span><br><span class="line">  401368:	eb 25                	jmp    40138f &lt;strings_not_equal+0x57&gt;</span><br><span class="line">  40136a:	3a 45 00             	cmp    0x0(%rbp),%al</span><br><span class="line">  40136d:	0f 1f 00             	nopl   (%rax)</span><br><span class="line">  401370:	75 24                	jne    401396 &lt;strings_not_equal+0x5e&gt;</span><br><span class="line">  401372:	48 83 c3 01          	add    $0x1,%rbx</span><br><span class="line">  401376:	48 83 c5 01          	add    $0x1,%rbp</span><br><span class="line">  40137a:	0f b6 03             	movzbl (%rbx),%eax</span><br><span class="line">  40137d:	84 c0                	test   %al,%al</span><br><span class="line">  40137f:	75 e9                	jne    40136a &lt;strings_not_equal+0x32&gt;</span><br><span class="line">  401381:	ba 00 00 00 00       	mov    $0x0,%edx</span><br><span class="line">  401386:	eb 13                	jmp    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  401388:	ba 00 00 00 00       	mov    $0x0,%edx</span><br><span class="line">  40138d:	eb 0c                	jmp    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  40138f:	ba 01 00 00 00       	mov    $0x1,%edx</span><br><span class="line">  401394:	eb 05                	jmp    40139b &lt;strings_not_equal+0x63&gt;</span><br><span class="line">  401396:	ba 01 00 00 00       	mov    $0x1,%edx</span><br><span class="line">  40139b:	89 d0                	mov    %edx,%eax</span><br><span class="line">  40139d:	5b                   	pop    %rbx</span><br><span class="line">  40139e:	5d                   	pop    %rbp</span><br><span class="line">  40139f:	41 5c                	pop    %r12</span><br><span class="line">  4013a1:	c3                   	retq</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">000000000040131b &lt;string_length&gt;:</span><br><span class="line">  40131b:	80 3f 00             	cmpb   $0x0,(%rdi)</span><br><span class="line">  40131e:	74 12                	je     401332 &lt;string_length+0x17&gt;</span><br><span class="line">  401320:	48 89 fa             	mov    %rdi,%rdx</span><br><span class="line">  401323:	48 83 c2 01          	add    $0x1,%rdx</span><br><span class="line">  401327:	89 d0                	mov    %edx,%eax</span><br><span class="line">  401329:	29 f8                	sub    %edi,%eax</span><br><span class="line">  40132b:	80 3a 00             	cmpb   $0x0,(%rdx)</span><br><span class="line">  40132e:	75 f3                	jne    401323 &lt;string_length+0x8&gt;</span><br><span class="line">  401330:	f3 c3                	repz retq </span><br><span class="line">  401332:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  401337:	c3                   	retq  </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">string_length</span><span class="params">(<span class="keyword">char</span> * s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">&#x27;\0&#x27;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> * rdx = s;</span><br><span class="line">    <span class="keyword">int</span> res ;</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        rdx++;</span><br><span class="line">        res = rdx - s;</span><br><span class="line">    &#125;<span class="keyword">while</span>(*rdx != <span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strings_not_equal</span><span class="params">(<span class="keyword">char</span> * input , <span class="keyword">char</span> * target)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> inputlen = string_length(input);</span><br><span class="line">    <span class="keyword">int</span> targetlen = string_length(target);</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( inputlen != targetlen)&#123; <span class="keyword">return</span> res; &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (input[<span class="number">0</span>] == <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">        res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (*input == *target)&#123;</span><br><span class="line">        	input++;</span><br><span class="line">        	target++; </span><br><span class="line">            <span class="keyword">if</span>(*input == <span class="string">&#x27;\0&#x27;</span>)&#123;</span><br><span class="line">                res = <span class="number">0</span>; <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">    	&#125;</span><br><span class="line">        res = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Phase 1 defused. How about the next one?</span><br></pre></td></tr></table></figure></li>
<li><p>Phase 2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">0000000000400efc &lt;phase_2&gt;:</span><br><span class="line">  400efc:	55                   	push   %rbp</span><br><span class="line">  400efd:	53                   	push   %rbx</span><br><span class="line">  400efe:	48 83 ec 28          	sub    $0x28,%rsp</span><br><span class="line">  400f02:	48 89 e6             	mov    %rsp,%rsi</span><br><span class="line">  400f05:	e8 52 05 00 00       	callq  40145c &lt;read_six_numbers&gt;</span><br><span class="line">  400f0a:	83 3c 24 01          	cmpl   $0x1,(%rsp)</span><br><span class="line">  400f0e:	74 20                	je     400f30 &lt;phase_2+0x34&gt;</span><br><span class="line">  400f10:	e8 25 05 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400f15:	eb 19                	jmp    400f30 &lt;phase_2+0x34&gt;</span><br><span class="line">  400f17:	8b 43 fc             	mov    -0x4(%rbx),%eax</span><br><span class="line">  400f1a:	01 c0                	add    %eax,%eax</span><br><span class="line">  400f1c:	39 03                	cmp    %eax,(%rbx)</span><br><span class="line">  400f1e:	74 05                	je     400f25 &lt;phase_2+0x29&gt;</span><br><span class="line">  400f20:	e8 15 05 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400f25:	48 83 c3 04          	add    $0x4,%rbx</span><br><span class="line">  400f29:	48 39 eb             	cmp    %rbp,%rbx</span><br><span class="line">  400f2c:	75 e9                	jne    400f17 &lt;phase_2+0x1b&gt;</span><br><span class="line">  400f2e:	eb 0c                	jmp    400f3c &lt;phase_2+0x40&gt;</span><br><span class="line">  400f30:	48 8d 5c 24 04       	lea    0x4(%rsp),%rbx</span><br><span class="line">  400f35:	48 8d 6c 24 18       	lea    0x18(%rsp),%rbp</span><br><span class="line">  400f3a:	eb db                	jmp    400f17 &lt;phase_2+0x1b&gt;</span><br><span class="line">  400f3c:	48 83 c4 28          	add    $0x28,%rsp</span><br><span class="line">  400f40:	5b                   	pop    %rbx</span><br><span class="line">  400f41:	5d                   	pop    %rbp</span><br><span class="line">  400f42:	c3                   	retq   </span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">000000000040145c &lt;read_six_numbers&gt;:</span><br><span class="line">  40145c:	48 83 ec 18          	sub    $0x18,%rsp</span><br><span class="line">  401460:	48 89 f2             	mov    %rsi,%rdx</span><br><span class="line">  401463:	48 8d 4e 04          	lea    0x4(%rsi),%rcx</span><br><span class="line">  401467:	48 8d 46 14          	lea    0x14(%rsi),%rax</span><br><span class="line">  40146b:	48 89 44 24 08       	mov    %rax,0x8(%rsp)</span><br><span class="line">  401470:	48 8d 46 10          	lea    0x10(%rsi),%rax</span><br><span class="line">  401474:	48 89 04 24          	mov    %rax,(%rsp)</span><br><span class="line">  401478:	4c 8d 4e 0c          	lea    0xc(%rsi),%r9</span><br><span class="line">  40147c:	4c 8d 46 08          	lea    0x8(%rsi),%r8</span><br><span class="line">  401480:	be c3 25 40 00       	mov    $0x4025c3,%esi</span><br><span class="line">  401485:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  40148a:	e8 61 f7 ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  40148f:	83 f8 05             	cmp    $0x5,%eax</span><br><span class="line">  401492:	7f 05                	jg     401499 &lt;read_six_numbers+0x3d&gt;</span><br><span class="line">  401494:	e8 a1 ff ff ff       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  401499:	48 83 c4 18          	add    $0x18,%rsp</span><br><span class="line">  40149d:	c3                   	retq </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_six_numbers</span><span class="params">(<span class="keyword">char</span>* input , <span class="keyword">int</span> buf [<span class="number">6</span>])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> * rdx = buf;</span><br><span class="line">    <span class="keyword">int</span>* rcx = buf + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> * local1 = buf + <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> * local0 = buf + <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">int</span> * r9 = buf + <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> * r8 = buf + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="built_in">sscanf</span>(input , <span class="string">&quot;%d %d %d %d %d %d&quot;</span> , rdx , rcx , r8 , r9 , local0 ,local1);</span><br><span class="line">    <span class="comment">//On success, the function returns the number of items in the argument list successfully filled. </span></span><br><span class="line">    <span class="keyword">if</span> (res &gt; <span class="number">5</span>)  <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">else</span> explode_bomb();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phase_2</span><span class="params">(<span class="keyword">char</span> * input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> numbers [<span class="number">6</span>] ;</span><br><span class="line">    read_six_numbers(<span class="keyword">char</span>* input , numbers );</span><br><span class="line">    <span class="keyword">if</span>(numbers[<span class="number">0</span>] != <span class="number">1</span>) explode_bomb();</span><br><span class="line">    <span class="keyword">int</span>* rbx = numbers + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span>* rbp = numbers + <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> temp = (*(rbx<span class="number">-1</span>))*<span class="number">2</span>;</span><br><span class="line">    	<span class="keyword">if</span> (temp == *rbx )</span><br><span class="line">        	rbx++;</span><br><span class="line">        <span class="keyword">else</span> explode_bomb();</span><br><span class="line">    &#125;<span class="keyword">while</span>(rbp != rbx);</span><br><span class="line">    <span class="comment">//1 2 4 8 16 32</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">That&#39;s number 2.  Keep going!</span><br></pre></td></tr></table></figure></li>
<li><p>Phase 3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">0000000000400f43 &lt;phase_3&gt;:</span><br><span class="line">  400f43:	48 83 ec 18          	sub    $0x18,%rsp</span><br><span class="line">  400f47:	48 8d 4c 24 0c       	lea    0xc(%rsp),%rcx</span><br><span class="line">  400f4c:	48 8d 54 24 08       	lea    0x8(%rsp),%rdx</span><br><span class="line">  400f51:	be cf 25 40 00       	mov    $0x4025cf,%esi</span><br><span class="line">  400f56:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  400f5b:	e8 90 fc ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  400f60:	83 f8 01             	cmp    $0x1,%eax</span><br><span class="line">  400f63:	7f 05                	jg     400f6a &lt;phase_3+0x27&gt;</span><br><span class="line">  400f65:	e8 d0 04 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400f6a:	83 7c 24 08 07       	cmpl   $0x7,0x8(%rsp)</span><br><span class="line">  400f6f:	77 3c                	ja     400fad &lt;phase_3+0x6a&gt;</span><br><span class="line">  400f71:	8b 44 24 08          	mov    0x8(%rsp),%eax</span><br><span class="line">  400f75:	ff 24 c5 70 24 40 00 	jmpq   *0x402470(,%rax,8) # use gdb</span><br><span class="line">  400f7c:	b8 cf 00 00 00       	mov    $0xcf,%eax</span><br><span class="line">  400f81:	eb 3b                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400f83:	b8 c3 02 00 00       	mov    $0x2c3,%eax</span><br><span class="line">  400f88:	eb 34                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400f8a:	b8 00 01 00 00       	mov    $0x100,%eax</span><br><span class="line">  400f8f:	eb 2d                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400f91:	b8 85 01 00 00       	mov    $0x185,%eax</span><br><span class="line">  400f96:	eb 26                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400f98:	b8 ce 00 00 00       	mov    $0xce,%eax</span><br><span class="line">  400f9d:	eb 1f                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400f9f:	b8 aa 02 00 00       	mov    $0x2aa,%eax</span><br><span class="line">  400fa4:	eb 18                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400fa6:	b8 47 01 00 00       	mov    $0x147,%eax</span><br><span class="line">  400fab:	eb 11                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400fad:	e8 88 04 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400fb2:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  400fb7:	eb 05                	jmp    400fbe &lt;phase_3+0x7b&gt;</span><br><span class="line">  400fb9:	b8 37 01 00 00       	mov    $0x137,%eax</span><br><span class="line">  400fbe:	3b 44 24 0c          	cmp    0xc(%rsp),%eax</span><br><span class="line">  400fc2:	74 05                	je     400fc9 &lt;phase_3+0x86&gt;</span><br><span class="line">  400fc4:	e8 71 04 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  400fc9:	48 83 c4 18          	add    $0x18,%rsp</span><br><span class="line">  400fcd:	c3                   	retq </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* .rodata</span></span><br><span class="line"><span class="comment">0x00402470 	7c0f4000 00000000 b90f4000 00000000 |.@.......@.....</span></span><br><span class="line"><span class="comment">0x00402480 	830f4000 00000000 8a0f4000 00000000 ..@.......@.....</span></span><br><span class="line"><span class="comment">0x00402490 	910f4000 00000000 980f4000 00000000 ..@.......@.....</span></span><br><span class="line"><span class="comment">0x004024a0 	9f0f4000 00000000 a60f4000 00000000 ..@.......@.....</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phase_3</span><span class="params">(<span class="keyword">char</span> * input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> * temp1 = alloca(<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">int</span> * temp0 = alloca(<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">int</span> receive_cot = <span class="built_in">sscanf</span>(input , <span class="string">&quot;%d %d&quot;</span> , temp0 , temp1);</span><br><span class="line">    <span class="keyword">if</span> (receive_cot &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)*temp0 &gt; <span class="number">7u</span>) &#123;explode_bomb(); <span class="comment">/* return 0;*/</span> &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> res = *temp0;</span><br><span class="line">            <span class="keyword">switch</span>(res)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                    res = <span class="number">207</span>;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    res = <span class="number">331</span>;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    res = <span class="number">707</span>;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    res = <span class="number">256</span>;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                    res = <span class="number">389</span>;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                    res = <span class="number">206</span>;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                    res = <span class="number">682</span>;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                    res = <span class="number">327</span>;<span class="keyword">break</span>;         </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (res != *temp1) explode_bomb();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> explode_bomb();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">0 207</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Halfway there!</span><br></pre></td></tr></table></figure>
</li>
<li><p>Phase 4</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">000000000040100c &lt;phase_4&gt;:</span><br><span class="line">  40100c:	48 83 ec 18          	sub    $0x18,%rsp</span><br><span class="line">  401010:	48 8d 4c 24 0c       	lea    0xc(%rsp),%rcx</span><br><span class="line">  401015:	48 8d 54 24 08       	lea    0x8(%rsp),%rdx</span><br><span class="line">  40101a:	be cf 25 40 00       	mov    $0x4025cf,%esi</span><br><span class="line">  40101f:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  401024:	e8 c7 fb ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  401029:	83 f8 02             	cmp    $0x2,%eax</span><br><span class="line">  40102c:	75 07                	jne    401035 &lt;phase_4+0x29&gt;</span><br><span class="line">  40102e:	83 7c 24 08 0e       	cmpl   $0xe,0x8(%rsp)</span><br><span class="line">  401033:	76 05                	jbe    40103a &lt;phase_4+0x2e&gt;</span><br><span class="line">  401035:	e8 00 04 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  40103a:	ba 0e 00 00 00       	mov    $0xe,%edx</span><br><span class="line">  40103f:	be 00 00 00 00       	mov    $0x0,%esi</span><br><span class="line">  401044:	8b 7c 24 08          	mov    0x8(%rsp),%edi</span><br><span class="line">  401048:	e8 81 ff ff ff       	callq  400fce &lt;func4&gt;</span><br><span class="line">  40104d:	85 c0                	test   %eax,%eax</span><br><span class="line">  40104f:	75 07                	jne    401058 &lt;phase_4+0x4c&gt;</span><br><span class="line">  401051:	83 7c 24 0c 00       	cmpl   $0x0,0xc(%rsp)</span><br><span class="line">  401056:	74 05                	je     40105d &lt;phase_4+0x51&gt;</span><br><span class="line">  401058:	e8 dd 03 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  40105d:	48 83 c4 18          	add    $0x18,%rsp</span><br><span class="line">  401061:	c3                   	retq   </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phase_4</span><span class="params">(<span class="keyword">char</span>* input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> * temp1 = alloca(<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">int</span> * temp0 = alloca(<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="keyword">int</span> receiv = <span class="built_in">sscanf</span>(input , <span class="string">&quot;%d %d&quot;</span> , temp0 ,temp1);</span><br><span class="line">    <span class="keyword">if</span> (receiv != <span class="number">2</span>) explode_bomb();</span><br><span class="line">    <span class="keyword">if</span> (*temp0 &gt; <span class="number">14u</span> ) explode_bomb();</span><br><span class="line">    <span class="keyword">int</span> res = func4(*temp0 , <span class="number">0</span> , <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">if</span> (res != <span class="number">0</span>) explode_bomb();</span><br><span class="line">    <span class="keyword">if</span> (*temp1 != <span class="number">0</span>) explode_bomb();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">0000000000400fce &lt;func4&gt;:</span><br><span class="line">  400fce:	48 83 ec 08          	sub    $0x8,%rsp</span><br><span class="line">  400fd2:	89 d0                	mov    %edx,%eax</span><br><span class="line">  400fd4:	29 f0                	sub    %esi,%eax</span><br><span class="line">  400fd6:	89 c1                	mov    %eax,%ecx</span><br><span class="line">  400fd8:	c1 e9 1f             	shr    $0x1f,%ecx</span><br><span class="line">  400fdb:	01 c8                	add    %ecx,%eax</span><br><span class="line">  400fdd:	d1 f8                	sar    %eax</span><br><span class="line">  400fdf:	8d 0c 30             	lea    (%rax,%rsi,1),%ecx</span><br><span class="line">  400fe2:	39 f9                	cmp    %edi,%ecx</span><br><span class="line">  400fe4:	7e 0c                	jle    400ff2 &lt;func4+0x24&gt;</span><br><span class="line">  400fe6:	8d 51 ff             	lea    -0x1(%rcx),%edx</span><br><span class="line">  400fe9:	e8 e0 ff ff ff       	callq  400fce &lt;func4&gt;</span><br><span class="line">  400fee:	01 c0                	add    %eax,%eax</span><br><span class="line">  400ff0:	eb 15                	jmp    401007 &lt;func4+0x39&gt;</span><br><span class="line">  400ff2:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  400ff7:	39 f9                	cmp    %edi,%ecx</span><br><span class="line">  400ff9:	7d 0c                	jge    401007 &lt;func4+0x39&gt;</span><br><span class="line">  400ffb:	8d 71 01             	lea    0x1(%rcx),%esi</span><br><span class="line">  400ffe:	e8 cb ff ff ff       	callq  400fce &lt;func4&gt;</span><br><span class="line">  401003:	8d 44 00 01          	lea    0x1(%rax,%rax,1),%eax</span><br><span class="line">  401007:	48 83 c4 08          	add    $0x8,%rsp</span><br><span class="line">  40100b:	c3                   	retq   </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func4</span><span class="params">(<span class="keyword">int</span>  temp0 , <span class="keyword">int</span> esi, <span class="keyword">int</span> edx)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = edx - esi;</span><br><span class="line">    res = res  + ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)res &gt;&gt; <span class="number">31</span>);</span><br><span class="line">    res &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> local = res + esi;</span><br><span class="line">    <span class="keyword">if</span> (local &lt;= temp0)&#123;</span><br><span class="line">        res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (local &gt;= temp0) <span class="keyword">return</span> res;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> func4(temp0 , local + <span class="number">1</span> , edx)* <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        edx = local - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> func4(temp0 , esi , edx)*<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//7 0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">So you got that one.  Try this one.</span><br></pre></td></tr></table></figure></li>
<li><p>Phase 5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">0000000000401062 &lt;phase_5&gt;:</span><br><span class="line">  401062:	53                   	push   %rbx</span><br><span class="line">  401063:	48 83 ec 20          	sub    $0x20,%rsp</span><br><span class="line">  401067:	48 89 fb             	mov    %rdi,%rbx</span><br><span class="line">  # get canary value</span><br><span class="line">  #40106a:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax</span><br><span class="line">  #401071:	00 00 </span><br><span class="line">  #401073:	48 89 44 24 18       	mov    %rax,0x18(%rsp)</span><br><span class="line">  401078:	31 c0                	xor    %eax,%eax</span><br><span class="line">  40107a:	e8 9c 02 00 00       	callq  40131b &lt;string_length&gt;</span><br><span class="line">  40107f:	83 f8 06             	cmp    $0x6,%eax</span><br><span class="line">  401082:	74 4e                	je     4010d2 &lt;phase_5+0x70&gt;</span><br><span class="line">  401084:	e8 b1 03 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  401089:	eb 47                	jmp    4010d2 &lt;phase_5+0x70&gt;</span><br><span class="line">  40108b:	0f b6 0c 03          	movzbl (%rbx,%rax,1),%ecx</span><br><span class="line">  40108f:	88 0c 24             	mov    %cl,(%rsp)</span><br><span class="line">  401092:	48 8b 14 24          	mov    (%rsp),%rdx</span><br><span class="line">  401096:	83 e2 0f             	and    $0xf,%edx</span><br><span class="line">  401099:	0f b6 92 b0 24 40 00 	movzbl 0x4024b0(%rdx),%edx</span><br><span class="line">  4010a0:	88 54 04 10          	mov    %dl,0x10(%rsp,%rax,1)</span><br><span class="line">  4010a4:	48 83 c0 01          	add    $0x1,%rax</span><br><span class="line">  4010a8:	48 83 f8 06          	cmp    $0x6,%rax</span><br><span class="line">  4010ac:	75 dd                	jne    40108b &lt;phase_5+0x29&gt;</span><br><span class="line">  4010ae:	c6 44 24 16 00       	movb   $0x0,0x16(%rsp)</span><br><span class="line">  4010b3:	be 5e 24 40 00       	mov    $0x40245e,%esi</span><br><span class="line">  4010b8:	48 8d 7c 24 10       	lea    0x10(%rsp),%rdi</span><br><span class="line">  4010bd:	e8 76 02 00 00       	callq  401338 &lt;strings_not_equal&gt;</span><br><span class="line">  4010c2:	85 c0                	test   %eax,%eax</span><br><span class="line">  4010c4:	74 13                	je     4010d9 &lt;phase_5+0x77&gt;</span><br><span class="line">  4010c6:	e8 6f 03 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  4010cb:	0f 1f 44 00 00       	nopl   0x0(%rax,%rax,1)</span><br><span class="line">  4010d0:	eb 07                	jmp    4010d9 &lt;phase_5+0x77&gt;</span><br><span class="line">  4010d2:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  4010d7:	eb b2                	jmp    40108b &lt;phase_5+0x29&gt;</span><br><span class="line">  #check canary value</span><br><span class="line">  #4010d9:	48 8b 44 24 18       	mov    0x18(%rsp),%rax</span><br><span class="line">  #4010de:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax</span><br><span class="line">  #4010e5:	00 00 </span><br><span class="line">  #4010e7:	74 05                	je     4010ee &lt;phase_5+0x8c&gt;</span><br><span class="line">  #4010e9:	e8 42 fa ff ff       	callq  400b30 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">  4010ee:	48 83 c4 20          	add    $0x20,%rsp</span><br><span class="line">  4010f2:	5b                   	pop    %rbx</span><br><span class="line">  4010f3:	c3                   	retq   </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phase_5</span><span class="params">(<span class="keyword">char</span>* input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> inputlen = string_length(input);</span><br><span class="line">    <span class="keyword">char</span> local [<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">if</span> (inputlen == <span class="number">6</span>)&#123;</span><br><span class="line"><span class="comment">//Tag:</span></span><br><span class="line">        <span class="keyword">int</span> rax = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ecx = input[rax];</span><br><span class="line">        <span class="keyword">char</span> rdx = ecx  &amp; <span class="number">0xf</span>;</span><br><span class="line">        <span class="keyword">char</span> * addr = <span class="number">0x4024b0</span>;</span><br><span class="line">            <span class="comment">//0x00 0x40 0x24 0xb0 0x6d 0x61 0x64 0x75 0x69 0x65 0x72 0x73 0x6e 0x66 0x6f 0x74 0x76 0x62 0x79 0x6c </span></span><br><span class="line">            <span class="comment">//m a d u i e r s n f o t v b y l</span></span><br><span class="line">        rdx = *(addr + rdx);</span><br><span class="line">        local[rax] = rdx;</span><br><span class="line">        rax++;</span><br><span class="line">        <span class="keyword">while</span>(rax != <span class="number">6</span>);</span><br><span class="line">        local[<span class="number">6</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="keyword">int</span> res = strings_not_equal(local , <span class="number">0x40245e</span>);</span><br><span class="line">            <span class="comment">//&quot;flyers&quot;</span></span><br><span class="line">        <span class="keyword">if</span> (res != <span class="number">0</span>) explode_bomb();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        explode_bomb();</span><br><span class="line">        <span class="comment">//goto Tag;</span></span><br><span class="line">        <span class="comment">//the compiler generate some codes which will never be executed.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//9,f,e,5,6,7</span></span><br><span class="line"><span class="comment">//&#x27;&#x27;.join([chr(0x40+i) for i in [9,0xf,0xe,5,6,7]])</span></span><br><span class="line"><span class="comment">//IONEFG</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Good work!  On to the next...</span><br></pre></td></tr></table></figure></li>
<li><p>Phase 6</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">00000000004010f4 &lt;phase_6&gt;:</span><br><span class="line">  4010f4:	41 56                	push   %r14</span><br><span class="line">  4010f6:	41 55                	push   %r13</span><br><span class="line">  4010f8:	41 54                	push   %r12</span><br><span class="line">  4010fa:	55                   	push   %rbp</span><br><span class="line">  4010fb:	53                   	push   %rbx</span><br><span class="line">  4010fc:	48 83 ec 50          	sub    $0x50,%rsp</span><br><span class="line">  401100:	49 89 e5             	mov    %rsp,%r13</span><br><span class="line">  401103:	48 89 e6             	mov    %rsp,%rsi</span><br><span class="line">  401106:	e8 51 03 00 00       	callq  40145c &lt;read_six_numbers&gt;</span><br><span class="line">  40110b:	49 89 e6             	mov    %rsp,%r14</span><br><span class="line">  40110e:	41 bc 00 00 00 00    	mov    $0x0,%r12d</span><br><span class="line">  401114:	4c 89 ed             	mov    %r13,%rbp</span><br><span class="line">  401117:	41 8b 45 00          	mov    0x0(%r13),%eax</span><br><span class="line">  40111b:	83 e8 01             	sub    $0x1,%eax</span><br><span class="line">  40111e:	83 f8 05             	cmp    $0x5,%eax</span><br><span class="line">  401121:	76 05                	jbe    401128 &lt;phase_6+0x34&gt;</span><br><span class="line">  401123:	e8 12 03 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  401128:	41 83 c4 01          	add    $0x1,%r12d</span><br><span class="line">  40112c:	41 83 fc 06          	cmp    $0x6,%r12d</span><br><span class="line">  401130:	74 21                	je     401153 &lt;phase_6+0x5f&gt;</span><br><span class="line">  401132:	44 89 e3             	mov    %r12d,%ebx</span><br><span class="line">  401135:	48 63 c3             	movslq %ebx,%rax</span><br><span class="line">  401138:	8b 04 84             	mov    (%rsp,%rax,4),%eax</span><br><span class="line">  40113b:	39 45 00             	cmp    %eax,0x0(%rbp)</span><br><span class="line">  40113e:	75 05                	jne    401145 &lt;phase_6+0x51&gt;</span><br><span class="line">  401140:	e8 f5 02 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  401145:	83 c3 01             	add    $0x1,%ebx</span><br><span class="line">  401148:	83 fb 05             	cmp    $0x5,%ebx</span><br><span class="line">  40114b:	7e e8                	jle    401135 &lt;phase_6+0x41&gt;</span><br><span class="line">  40114d:	49 83 c5 04          	add    $0x4,%r13</span><br><span class="line">  401151:	eb c1                	jmp    401114 &lt;phase_6+0x20&gt;</span><br><span class="line">  401153:	48 8d 74 24 18       	lea    0x18(%rsp),%rsi</span><br><span class="line">  401158:	4c 89 f0             	mov    %r14,%rax</span><br><span class="line">  40115b:	b9 07 00 00 00       	mov    $0x7,%ecx</span><br><span class="line">  401160:	89 ca                	mov    %ecx,%edx</span><br><span class="line">  401162:	2b 10                	sub    (%rax),%edx</span><br><span class="line">  401164:	89 10                	mov    %edx,(%rax)</span><br><span class="line">  401166:	48 83 c0 04          	add    $0x4,%rax</span><br><span class="line">  40116a:	48 39 f0             	cmp    %rsi,%rax</span><br><span class="line">  40116d:	75 f1                	jne    401160 &lt;phase_6+0x6c&gt;</span><br><span class="line">  40116f:	be 00 00 00 00       	mov    $0x0,%esi</span><br><span class="line">  401174:	eb 21                	jmp    401197 &lt;phase_6+0xa3&gt;</span><br><span class="line">  401176:	48 8b 52 08          	mov    0x8(%rdx),%rdx</span><br><span class="line">  40117a:	83 c0 01             	add    $0x1,%eax</span><br><span class="line">  40117d:	39 c8                	cmp    %ecx,%eax</span><br><span class="line">  40117f:	75 f5                	jne    401176 &lt;phase_6+0x82&gt;</span><br><span class="line">  401181:	eb 05                	jmp    401188 &lt;phase_6+0x94&gt;</span><br><span class="line">  401183:	ba d0 32 60 00       	mov    $0x6032d0,%edx</span><br><span class="line">  401188:	48 89 54 74 20       	mov    %rdx,0x20(%rsp,%rsi,2)</span><br><span class="line">  40118d:	48 83 c6 04          	add    $0x4,%rsi</span><br><span class="line">  401191:	48 83 fe 18          	cmp    $0x18,%rsi</span><br><span class="line">  401195:	74 14                	je     4011ab &lt;phase_6+0xb7&gt;</span><br><span class="line">  401197:	8b 0c 34             	mov    (%rsp,%rsi,1),%ecx</span><br><span class="line">  40119a:	83 f9 01             	cmp    $0x1,%ecx</span><br><span class="line">  40119d:	7e e4                	jle    401183 &lt;phase_6+0x8f&gt;</span><br><span class="line">  40119f:	b8 01 00 00 00       	mov    $0x1,%eax</span><br><span class="line">  4011a4:	ba d0 32 60 00       	mov    $0x6032d0,%edx</span><br><span class="line">  4011a9:	eb cb                	jmp    401176 &lt;phase_6+0x82&gt;</span><br><span class="line">  4011ab:	48 8b 5c 24 20       	mov    0x20(%rsp),%rbx</span><br><span class="line">  4011b0:	48 8d 44 24 28       	lea    0x28(%rsp),%rax</span><br><span class="line">  4011b5:	48 8d 74 24 50       	lea    0x50(%rsp),%rsi</span><br><span class="line">  4011ba:	48 89 d9             	mov    %rbx,%rcx</span><br><span class="line">  4011bd:	48 8b 10             	mov    (%rax),%rdx</span><br><span class="line">  4011c0:	48 89 51 08          	mov    %rdx,0x8(%rcx)</span><br><span class="line">  4011c4:	48 83 c0 08          	add    $0x8,%rax</span><br><span class="line">  4011c8:	48 39 f0             	cmp    %rsi,%rax</span><br><span class="line">  4011cb:	74 05                	je     4011d2 &lt;phase_6+0xde&gt;</span><br><span class="line">  4011cd:	48 89 d1             	mov    %rdx,%rcx</span><br><span class="line">  4011d0:	eb eb                	jmp    4011bd &lt;phase_6+0xc9&gt;</span><br><span class="line">  4011d2:	48 c7 42 08 00 00 00 	movq   $0x0,0x8(%rdx)</span><br><span class="line">  4011d9:	00 </span><br><span class="line">  4011da:	bd 05 00 00 00       	mov    $0x5,%ebp</span><br><span class="line">  4011df:	48 8b 43 08          	mov    0x8(%rbx),%rax</span><br><span class="line">  4011e3:	8b 00                	mov    (%rax),%eax</span><br><span class="line">  4011e5:	39 03                	cmp    %eax,(%rbx)</span><br><span class="line">  4011e7:	7d 05                	jge    4011ee &lt;phase_6+0xfa&gt;</span><br><span class="line">  4011e9:	e8 4c 02 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  4011ee:	48 8b 5b 08          	mov    0x8(%rbx),%rbx</span><br><span class="line">  4011f2:	83 ed 01             	sub    $0x1,%ebp</span><br><span class="line">  4011f5:	75 e8                	jne    4011df &lt;phase_6+0xeb&gt;</span><br><span class="line">  4011f7:	48 83 c4 50          	add    $0x50,%rsp</span><br><span class="line">  4011fb:	5b                   	pop    %rbx</span><br><span class="line">  4011fc:	5d                   	pop    %rbp</span><br><span class="line">  4011fd:	41 5c                	pop    %r12</span><br><span class="line">  4011ff:	41 5d                	pop    %r13</span><br><span class="line">  401201:	41 5e                	pop    %r14</span><br><span class="line">  401203:	c3                   	retq   </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phase_6</span><span class="params">(<span class="keyword">char</span>* input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> numbers[<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">int</span> * walk = numbers;</span><br><span class="line">    read_six_numbers(input , numbers);</span><br><span class="line">    <span class="keyword">int</span> * r14 = numbers;</span><br><span class="line">    <span class="keyword">int</span> check_times = <span class="number">0</span>;</span><br><span class="line">Loop:</span><br><span class="line">    <span class="keyword">int</span> * rbp = walk;</span><br><span class="line">    <span class="keyword">if</span> ( (*walk - <span class="number">1</span>) &gt; <span class="number">5u</span>) &#123; explode_bomb();&#125;</span><br><span class="line">    check_times++;</span><br><span class="line">    <span class="keyword">if</span> (check_times == <span class="number">6</span>)&#123;</span><br><span class="line">        <span class="comment">//change numbers to (7 - origin number)</span></span><br><span class="line">        <span class="keyword">int</span> * end = numbers+<span class="number">6</span>;</span><br><span class="line">        <span class="keyword">int</span> * p = numbers;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">        *p = <span class="number">7</span> - *p;</span><br><span class="line">        p++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>( p != end);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//use memory value to update stack value</span></span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>; <span class="comment">//rsi</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> ((rcx = numbers[index]) &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> rdx = <span class="number">0x6032d0</span>;</span><br><span class="line">    Resume:</span><br><span class="line">            *(numbers + <span class="number">8</span> + <span class="number">2</span>*index) = rdx; <span class="comment">//write memory value to stack space</span></span><br><span class="line">            index++;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (index == <span class="number">6</span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> rbx = *(numbers+<span class="number">8</span>); <span class="comment">//6032d0  </span></span><br><span class="line">                <span class="keyword">int</span> * res = numbers+<span class="number">10</span>; <span class="comment">//6032e0</span></span><br><span class="line">                <span class="keyword">int</span> * boundary = numbers + <span class="number">20</span>;</span><br><span class="line">                <span class="keyword">int</span> rcx = *(numbers+<span class="number">8</span>) ;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//write back value fetched from memory, beware of the order</span></span><br><span class="line">                <span class="keyword">do</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> rdx = *res;</span><br><span class="line">                *((<span class="keyword">long</span> *)(rcx+<span class="number">0x8</span>)) = rdx;</span><br><span class="line">                res+=<span class="number">2</span>; </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span>(res != boundary , rcx = rdx);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//final 6 checks</span></span><br><span class="line"></span><br><span class="line">                *(rdx+<span class="number">0x8</span>) = <span class="number">0</span>;     <span class="comment">//clear a chunk of memory</span></span><br><span class="line">                <span class="keyword">int</span> cnt = <span class="number">5</span>;    <span class="comment">//rbp</span></span><br><span class="line">                <span class="keyword">do</span>&#123;</span><br><span class="line">                res = *((<span class="keyword">long</span> *)rbx+<span class="number">0x8</span>);</span><br><span class="line">                res = *res;</span><br><span class="line">                <span class="comment">//compare stack value, *rbx, and memory value, res</span></span><br><span class="line">                <span class="keyword">if</span> ( *rbx &lt; res) &#123; explode_bomb(); &#125;</span><br><span class="line">                rbx = *(rbx+<span class="number">0x8</span>);</span><br><span class="line">                cnt--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (cnt != <span class="number">0</span> );</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//fetch a value from memory : *(0x6032d0 + 8*(rcx-1))</span></span><br><span class="line">        rax = <span class="number">1</span>;</span><br><span class="line">        rdx = <span class="number">0x6032d0</span>;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">        rdx = *(rdx + <span class="number">8</span>); </span><br><span class="line">        <span class="comment">//0x6032e0 //0x6032f0 //0x603300 //0x603310 //0x603320</span></span><br><span class="line">        rax++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(rax != rcx);</span><br><span class="line">        <span class="comment">//offset (rcx - 1) times</span></span><br><span class="line">        <span class="keyword">goto</span> Resume;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//int rbx = r12;</span></span><br><span class="line">        <span class="keyword">int</span> cot = check_times; <span class="comment">// %ebx is the cot</span></span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> next = numbers[cot];</span><br><span class="line">        <span class="keyword">if</span> (*walk == next) &#123; explode_bomb();&#125;</span><br><span class="line">        cot++;</span><br><span class="line">        &#125;<span class="keyword">while</span>( cot &lt;= <span class="number">5</span>);</span><br><span class="line">        walk ++;</span><br><span class="line">        <span class="keyword">goto</span> Loop;</span><br><span class="line">    <span class="comment">//every round of checking r13 points to next number</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1. every number - 1 should &lt;= 5u</span></span><br><span class="line"><span class="comment">2. evry number should be different</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h4 id="Dynamic-analysis-for-phase-6"><a href="#Dynamic-analysis-for-phase-6" class="headerlink" title="Dynamic analysis for phase 6"></a>Dynamic analysis for phase 6</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x &#x2F;14gx 0x6032d0</span><br><span class="line">0x6032d0 &lt;node1&gt;:	0x000000010000014c	0x00000000006032e0</span><br><span class="line">0x6032e0 &lt;node2&gt;:	0x00000002000000a8	0x00000000006032f0</span><br><span class="line">0x6032f0 &lt;node3&gt;:	0x000000030000039c	0x0000000000603300</span><br><span class="line">0x603300 &lt;node4&gt;:	0x00000004000002b3	0x0000000000603310</span><br><span class="line">0x603310 &lt;node5&gt;:	0x00000005000001dd	0x0000000000603320</span><br><span class="line">0x603320 &lt;node6&gt;:	0x00000006000001bb	0x0000000000000000</span><br><span class="line">0x603330:			0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x6032d0</span> : <span class="number">0x000000010000014c</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x6032d8</span> : <span class="number">0x00000000006032e0</span> <span class="comment"># pointer</span></span><br><span class="line"><span class="number">0x6032e0</span> : <span class="number">0x00000002000000a8</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x6032e8</span> : <span class="number">0x00000000006032f0</span> <span class="comment"># pointer</span></span><br><span class="line"><span class="number">0x6032f0</span> : <span class="number">0x000000030000039c</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x6032f8</span> : <span class="number">0x0000000000603300</span> <span class="comment"># pointer</span></span><br><span class="line"><span class="number">0x603300</span> : <span class="number">0x00000004000002b3</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x603308</span> : <span class="number">0x0000000000603310</span> <span class="comment"># pointer</span></span><br><span class="line"><span class="number">0x603310</span> : <span class="number">0x00000005000001dd</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x603318</span> : <span class="number">0x0000000000603320</span> <span class="comment"># pointer</span></span><br><span class="line"><span class="number">0x603320</span> : <span class="number">0x00000006000001bb</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x603328</span> : <span class="number">0x0000000000000000</span> <span class="comment"># 0</span></span><br><span class="line"><span class="number">0x603330</span> : <span class="number">0x0000000000000000</span> <span class="comment"># 0</span></span><br><span class="line"><span class="comment"># 5 pointers , 6 values</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x &#x2F;12gx $rsp</span><br><span class="line">0x7fffffffe320:	0x0000000000000000	0x00007ffff7dcda00</span><br><span class="line">0x7fffffffe330:	0x0000000000603910	# end of number array</span><br><span class="line">0x7fffffffe338: 0x0000000000000000</span><br><span class="line"></span><br><span class="line"># start of hidden space</span><br><span class="line">0x7fffffffe340:	0x00007fffffffe480	0x0000000000000000</span><br><span class="line">0x7fffffffe350:	0x0000000000000000	0x00000000004013cc</span><br><span class="line">0x7fffffffe360:	0x00007fffffffe488	0x0000000000603910</span><br><span class="line"># end of hiddne space</span><br><span class="line"></span><br><span class="line">0x7fffffffe370:	0x00007fffffffe488	0x0000000000402210</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x &#x2F;12gx 0x6032d0                                              </span><br><span class="line">0x6032d0 &lt;node1&gt;:       0x000000010000014c      0x00000000006032e0         </span><br><span class="line">0x6032e0 &lt;node2&gt;:       0x00000002000000a8      0x0000000000000000         </span><br><span class="line">0x6032f0 &lt;node3&gt;:       0x000000030000039c      0x0000000000603300         </span><br><span class="line">0x603300 &lt;node4&gt;:       0x00000004000002b3      0x0000000000603310         </span><br><span class="line">0x603310 &lt;node5&gt;:       0x00000005000001dd      0x0000000000603320         </span><br><span class="line">0x603320 &lt;node6&gt;:       0x00000006000001bb      0x00000000006032d0</span><br></pre></td></tr></table></figure>
<p>Correct C code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">explode_bomb</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phase_6</span><span class="params">(<span class="keyword">char</span>* input)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> numbers[<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">int</span> * walk = numbers;</span><br><span class="line">    read_six_numbers(input , numbers);</span><br><span class="line">    <span class="keyword">int</span> check_times = <span class="number">0</span>;</span><br><span class="line">Loop:</span><br><span class="line">    <span class="keyword">if</span> ( (*walk - <span class="number">1</span>) &gt; <span class="number">5u</span>) &#123; explode_bomb();&#125;   <span class="comment">// numbers should be in set&#123;1, 2, 3, 4, 5, 6&#125; </span></span><br><span class="line">    check_times++;</span><br><span class="line">    <span class="keyword">if</span> (check_times == <span class="number">6</span>)&#123;</span><br><span class="line">        <span class="comment">//change numbers to (7 - origin number)</span></span><br><span class="line">        <span class="keyword">int</span> * end = numbers+<span class="number">6</span>;</span><br><span class="line">        <span class="keyword">int</span> * p = numbers;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">        *p = <span class="number">7</span> - *p;</span><br><span class="line">        p++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>( p != end);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//use memory value to update stack value</span></span><br><span class="line">        <span class="comment">//update one by one use rdx</span></span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>; <span class="comment">//rsi</span></span><br><span class="line">        <span class="comment">//instruction at 0x401197</span></span><br><span class="line">        <span class="keyword">while</span> ((rcx = numbers[index]) &lt;= <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="comment">//instruction at 401183</span></span><br><span class="line">            <span class="keyword">int</span> rdx = <span class="number">0x6032d0</span>;</span><br><span class="line">    Resume:</span><br><span class="line">            *(numbers + <span class="number">8</span> + <span class="number">2</span>*index) = rdx; <span class="comment">//write memory value to stack space 6 times</span></span><br><span class="line">            index++;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (index == <span class="number">6</span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">int</span> mstartp = *(numbers+<span class="number">8</span>); </span><br><span class="line">                <span class="keyword">int</span> * next = numbers+<span class="number">10</span>; </span><br><span class="line">                <span class="keyword">int</span> * boundary = numbers + <span class="number">20</span>;</span><br><span class="line">                <span class="keyword">int</span> saver = *(numbers+<span class="number">8</span>) ;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">//write back value fetched from memory, only write 5 times, the first value is preserved to indicate start point of final check</span></span><br><span class="line">                <span class="comment">//Beware of the order</span></span><br><span class="line">                <span class="keyword">do</span>&#123;</span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">long</span> content = *next ;</span><br><span class="line">                *(saver+<span class="number">0x8</span>) = content ;  <span class="comment">//only value at address in form of 0x........8 can be changed</span></span><br><span class="line">                <span class="comment">//use saver as a pointer to write to the position (saver + 0x8)</span></span><br><span class="line">                next+=<span class="number">2</span>; </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span>(next != boundary , saver = content );</span><br><span class="line">                <span class="comment">/* violate C syntax here</span></span><br><span class="line"><span class="comment">                 * valid code can be like</span></span><br><span class="line"><span class="comment">                 * </span></span><br><span class="line"><span class="comment">                 * do&#123;</span></span><br><span class="line"><span class="comment">                 * ......</span></span><br><span class="line"><span class="comment">                 * if (next != boundary ) break;</span></span><br><span class="line"><span class="comment">                 * saver = content;</span></span><br><span class="line"><span class="comment">                 * &#125;while(1);</span></span><br><span class="line"><span class="comment">                 * </span></span><br><span class="line"><span class="comment">                 */</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//final 5 checks</span></span><br><span class="line">                *(rdx+<span class="number">0x8</span>) = <span class="number">0</span>;     <span class="comment">//set the last node of pointing chain&#x27;s &quot;link&quot; to 0x0</span></span><br><span class="line">                <span class="comment">//instruction at 0x00000000004011da</span></span><br><span class="line">                <span class="keyword">int</span> cnt = <span class="number">5</span>;    <span class="comment">//%rbp</span></span><br><span class="line">                <span class="keyword">do</span>&#123;</span><br><span class="line">                <span class="comment">//mstartp can serve as a pointer of pointer</span></span><br><span class="line">                <span class="keyword">int</span> * adjacent = *(mstartp+<span class="number">0x8</span>);</span><br><span class="line">                <span class="comment">//compare memory values</span></span><br><span class="line">                <span class="keyword">if</span> ( *mstartp &lt; *adjacent) &#123; explode_bomb(); &#125;</span><br><span class="line">                mstartp = adjacent;</span><br><span class="line">                <span class="comment">//update mstartp to what it is pointing</span></span><br><span class="line">                cnt--;</span><br><span class="line">                &#125; <span class="keyword">while</span> (cnt != <span class="number">0</span> );</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//fetch a value from memory : *(0x6032d0 + 8*(rcx-1))</span></span><br><span class="line">        rax = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//instruction at 0x4011a4</span></span><br><span class="line">        rdx = <span class="number">0x6032d0</span>;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">        rdx = *(rdx + <span class="number">8</span>); <span class="comment">//0x6032e0 //0x6032f0 //0x603300 //0x603310 //0x603320</span></span><br><span class="line">        rax++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(rax != rcx); <span class="comment">//offset (rcx - 1) times</span></span><br><span class="line">        <span class="keyword">goto</span> Resume;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cot = check_times; <span class="comment">// %ebx is the cot</span></span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> next = numbers[cot];</span><br><span class="line">        <span class="keyword">if</span> (*walk == next) &#123; explode_bomb();&#125;</span><br><span class="line">        cot++;</span><br><span class="line">        &#125;<span class="keyword">while</span>( cot &lt;= <span class="number">5</span> );</span><br><span class="line">        walk ++;</span><br><span class="line">        <span class="keyword">goto</span> Loop;</span><br><span class="line">    <span class="comment">//after one round of checking r13 points to next number</span></span><br><span class="line">    <span class="comment">//every number should be different</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Correct layout of memory values</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># movl to retrive value from memory</span></span><br><span class="line"><span class="comment"># so the data type is int rather than long !!!!</span></span><br><span class="line">d = &#123;</span><br><span class="line">fifth <span class="number">0x6032d0</span> : <span class="number">332</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x6032d8</span> : <span class="number">0x6032e0</span> <span class="comment"># pointer</span></span><br><span class="line"><span class="number">0x6032e0</span> : <span class="number">168</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x6032e8</span> : <span class="number">0</span> <span class="comment"># pointer</span></span><br><span class="line">first <span class="number">0x6032f0</span> : <span class="number">924</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x6032f8</span> : <span class="number">0x603300</span> <span class="comment"># pointer</span></span><br><span class="line">second <span class="number">0x603300</span> : <span class="number">691</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x603308</span> : <span class="number">0x603310</span> <span class="comment"># pointer</span></span><br><span class="line">third <span class="number">0x603310</span> : <span class="number">477</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x603318</span> : <span class="number">0x603320</span> <span class="comment"># pointer</span></span><br><span class="line">fourth <span class="number">0x603320</span> : <span class="number">443</span> <span class="comment"># value</span></span><br><span class="line"><span class="number">0x603328</span> : <span class="number">0x6032d0</span> <span class="comment"># 0</span></span><br><span class="line"><span class="number">0x603330</span> : <span class="number">0x000000000</span> <span class="comment"># 0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 4 3 2 1 6 5</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Congratulations! You&#39;ve defused the bomb!</span><br></pre></td></tr></table></figure>
<p><strong><em>When working with low level codes the most important thing is patience.</em></strong></p>
<h4 id="Secret-Phase"><a href="#Secret-Phase" class="headerlink" title="Secret Phase"></a>Secret Phase</h4><p><em>by examing the assembly code  generated by <code>objdump</code>, we can see that there is a call to <code>secret_phase</code> in function <code>phase_defused</code></em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">00000000004015c4 &lt;phase_defused&gt;:</span><br><span class="line">  4015c4:	48 83 ec 78          	sub    $0x78,%rsp</span><br><span class="line">  # canary</span><br><span class="line">  #4015c8:	64 48 8b 04 25 28 00 	mov    %fs:0x28,%rax</span><br><span class="line">  #4015cf:	00 00 </span><br><span class="line">  #4015d1:	48 89 44 24 68       	mov    %rax,0x68(%rsp)</span><br><span class="line">  4015d6:	31 c0                	xor    %eax,%eax</span><br><span class="line">  4015d8:	83 3d 81 21 20 00 06 	cmpl   $0x6,0x202181(%rip)        # 603760 &lt;num_input_strings&gt;</span><br><span class="line">  4015df:	75 5e                	jne    40163f &lt;phase_defused+0x7b&gt;</span><br><span class="line">  4015e1:	4c 8d 44 24 10       	lea    0x10(%rsp),%r8</span><br><span class="line">  4015e6:	48 8d 4c 24 0c       	lea    0xc(%rsp),%rcx</span><br><span class="line">  4015eb:	48 8d 54 24 08       	lea    0x8(%rsp),%rdx</span><br><span class="line">  4015f0:	be 19 26 40 00       	mov    $0x402619,%esi</span><br><span class="line">  4015f5:	bf 70 38 60 00       	mov    $0x603870,%edi</span><br><span class="line">  4015fa:	e8 f1 f5 ff ff       	callq  400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">  4015ff:	83 f8 03             	cmp    $0x3,%eax</span><br><span class="line">  401602:	75 31                	jne    401635 &lt;phase_defused+0x71&gt;</span><br><span class="line">  401604:	be 22 26 40 00       	mov    $0x402622,%esi</span><br><span class="line">  401609:	48 8d 7c 24 10       	lea    0x10(%rsp),%rdi</span><br><span class="line">  40160e:	e8 25 fd ff ff       	callq  401338 &lt;strings_not_equal&gt;</span><br><span class="line">  401613:	85 c0                	test   %eax,%eax</span><br><span class="line">  401615:	75 1e                	jne    401635 &lt;phase_defused+0x71&gt;</span><br><span class="line">  401617:	bf f8 24 40 00       	mov    $0x4024f8,%edi</span><br><span class="line">  40161c:	e8 ef f4 ff ff       	callq  400b10 &lt;puts@plt&gt;</span><br><span class="line">  401621:	bf 20 25 40 00       	mov    $0x402520,%edi</span><br><span class="line">  401626:	e8 e5 f4 ff ff       	callq  400b10 &lt;puts@plt&gt;</span><br><span class="line">  40162b:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  401630:	e8 0d fc ff ff       	callq  401242 &lt;secret_phase&gt;</span><br><span class="line">  401635:	bf 58 25 40 00       	mov    $0x402558,%edi</span><br><span class="line">  40163a:	e8 d1 f4 ff ff       	callq  400b10 &lt;puts@plt&gt;</span><br><span class="line">  #check canary</span><br><span class="line">  #40163f:	48 8b 44 24 68       	mov    0x68(%rsp),%rax</span><br><span class="line">  #401644:	64 48 33 04 25 28 00 	xor    %fs:0x28,%rax</span><br><span class="line">  #40164b:	00 00 </span><br><span class="line">  40164d:	74 05                	je     401654 &lt;phase_defused+0x90&gt;</span><br><span class="line">  #40164f:	e8 dc f4 ff ff       	callq  400b30 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">  401654:	48 83 c4 78          	add    $0x78,%rsp</span><br><span class="line">  401658:	c3                   	retq   </span><br><span class="line">  401659:	90                   	nop</span><br><span class="line">  40165a:	90                   	nop</span><br><span class="line">  40165b:	90                   	nop</span><br><span class="line">  40165c:	90                   	nop</span><br><span class="line">  40165d:	90                   	nop</span><br><span class="line">  40165e:	90                   	nop</span><br><span class="line">  40165f:	90                   	nop</span><br></pre></td></tr></table></figure>
<p>What is <code>num_input_strings</code> ?</p>
<ul>
<li><p>No codes named <code>num_input_string</code> in assembly</p>
</li>
<li><p>Search the symbols</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cat symbols | grep <span class="string">&#x27;num_input_strings&#x27;</span></span><br><span class="line">0000000000603760 g   O .bss	0000000000000004       num_input_strings</span><br></pre></td></tr></table></figure>
<p>But what is <code>.bss</code> section ?</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ readelf -x .bss bomb</span><br><span class="line">Section <span class="string">&#x27;.bss&#x27;</span> has no data to dump.</span><br></pre></td></tr></table></figure></li>
<li><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/1909953/regarding-the-bss-segment-and-data-segment-in-unix">uninitialized static data</a></p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> num_input_strings; <span class="comment">//count of input string number</span></span><br><span class="line"><span class="keyword">char</span> * slution_to_phase_4 = <span class="string">&quot;7 0&quot;</span></span><br><span class="line"><span class="keyword">void</span> phase_defused(<span class="keyword">void</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (num_input_strings != <span class="number">6</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">short</span>* local0 = alloca(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">short</span>* local1 = alloca(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">char</span> * local2 ;</span><br><span class="line">        <span class="keyword">int</span> receive = <span class="built_in">sscanf</span>(slution_to_phase_4 , <span class="string">&quot;%d %d %s&quot;</span> , local0 , local1 ,local2);</span><br><span class="line">        <span class="comment">//we need to append an extra string to solution_of_phase_4</span></span><br><span class="line">        <span class="keyword">if</span> (receive != <span class="number">3</span>) &#123;</span><br><span class="line">        Normal:</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Congratulations! You&#x27;ve defused the bomb!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> res = strings_not_equal(local2 , <span class="string">&quot;DrEvil&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (res != <span class="number">0</span>)&#123; <span class="keyword">goto</span> Normal ;&#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;Curses, you&#x27;ve found the secret phase!&quot;</span>);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">&quot;But finding it and solving it are quite different...&quot;</span>);</span><br><span class="line">                res = <span class="number">0</span>;</span><br><span class="line">                secret_phase();</span><br><span class="line">                <span class="keyword">goto</span> Normal;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">0000000000401242 &lt;secret_phase&gt;:</span><br><span class="line">  401242:	53                   	push   %rbx</span><br><span class="line">  401243:	e8 56 02 00 00       	callq  40149e &lt;read_line&gt;</span><br><span class="line">  401248:	ba 0a 00 00 00       	mov    $0xa,%edx</span><br><span class="line">  40124d:	be 00 00 00 00       	mov    $0x0,%esi</span><br><span class="line">  401252:	48 89 c7             	mov    %rax,%rdi</span><br><span class="line">  401255:	e8 76 f9 ff ff       	callq  400bd0 &lt;strtol@plt&gt;</span><br><span class="line">  40125a:	48 89 c3             	mov    %rax,%rbx</span><br><span class="line">  40125d:	8d 40 ff             	lea    -0x1(%rax),%eax</span><br><span class="line">  401260:	3d e8 03 00 00       	cmp    $0x3e8,%eax</span><br><span class="line">  401265:	76 05                	jbe    40126c &lt;secret_phase+0x2a&gt;</span><br><span class="line">  401267:	e8 ce 01 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  40126c:	89 de                	mov    %ebx,%esi</span><br><span class="line">  40126e:	bf f0 30 60 00       	mov    $0x6030f0,%edi</span><br><span class="line">  401273:	e8 8c ff ff ff       	callq  401204 &lt;fun7&gt;</span><br><span class="line">  401278:	83 f8 02             	cmp    $0x2,%eax</span><br><span class="line">  40127b:	74 05                	je     401282 &lt;secret_phase+0x40&gt;</span><br><span class="line">  40127d:	e8 b8 01 00 00       	callq  40143a &lt;explode_bomb&gt;</span><br><span class="line">  401282:	bf 38 24 40 00       	mov    $0x402438,%edi</span><br><span class="line">  401287:	e8 84 f8 ff ff       	callq  400b10 &lt;puts@plt&gt;</span><br><span class="line">  40128c:	e8 33 03 00 00       	callq  4015c4 &lt;phase_defused&gt;</span><br><span class="line">  401291:	5b                   	pop    %rbx</span><br><span class="line">  401292:	c3                   	retq   </span><br><span class="line">  401293:	90                   	nop</span><br><span class="line">  401294:	90                   	nop</span><br><span class="line">  401295:	90                   	nop</span><br><span class="line">  401296:	90                   	nop</span><br><span class="line">  401297:	90                   	nop</span><br><span class="line">  401298:	90                   	nop</span><br><span class="line">  401299:	90                   	nop</span><br><span class="line">  40129a:	90                   	nop</span><br><span class="line">  40129b:	90                   	nop</span><br><span class="line">  40129c:	90                   	nop</span><br><span class="line">  40129d:	90                   	nop</span><br><span class="line">  40129e:	90                   	nop</span><br><span class="line">  40129f:	90                   	nop</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">secret_phase</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> * input = read_line();</span><br><span class="line">    <span class="keyword">long</span> number = strtol(input , <span class="string">&#x27;\0&#x27;</span> , <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">long</span> save = number; <span class="comment">//rbx</span></span><br><span class="line">    number = number - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (number &lt;= <span class="number">0x3e8</span>u )&#123;</span><br><span class="line">        <span class="keyword">int</span> res = fun7(<span class="number">0x6030f0</span> , save);</span><br><span class="line">        <span class="keyword">if</span>(res == <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Wow! You&#x27;ve defused the secret stage!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            explode_bomb();</span><br><span class="line">        &#125;</span><br><span class="line">        phase_defused();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        explode_bomb();</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">0000000000401204 &lt;fun7&gt;:</span><br><span class="line">  401204:	48 83 ec 08          	sub    $0x8,%rsp</span><br><span class="line">  401208:	48 85 ff             	test   %rdi,%rdi</span><br><span class="line">  40120b:	74 2b                	je     401238 &lt;fun7+0x34&gt;</span><br><span class="line">  40120d:	8b 17                	mov    (%rdi),%edx</span><br><span class="line">  40120f:	39 f2                	cmp    %esi,%edx</span><br><span class="line">  401211:	7e 0d                	jle    401220 &lt;fun7+0x1c&gt;</span><br><span class="line">  401213:	48 8b 7f 08          	mov    0x8(%rdi),%rdi</span><br><span class="line">  401217:	e8 e8 ff ff ff       	callq  401204 &lt;fun7&gt;</span><br><span class="line">  40121c:	01 c0                	add    %eax,%eax</span><br><span class="line">  40121e:	eb 1d                	jmp    40123d &lt;fun7+0x39&gt;</span><br><span class="line">  401220:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  401225:	39 f2                	cmp    %esi,%edx</span><br><span class="line">  401227:	74 14                	je     40123d &lt;fun7+0x39&gt;</span><br><span class="line">  401229:	48 8b 7f 10          	mov    0x10(%rdi),%rdi</span><br><span class="line">  40122d:	e8 d2 ff ff ff       	callq  401204 &lt;fun7&gt;</span><br><span class="line">  401232:	8d 44 00 01          	lea    0x1(%rax,%rax,1),%eax</span><br><span class="line">  401236:	eb 05                	jmp    40123d &lt;fun7+0x39&gt;</span><br><span class="line">  401238:	b8 ff ff ff ff       	mov    $0xffffffff,%eax</span><br><span class="line">  40123d:	48 83 c4 08          	add    $0x8,%rsp</span><br><span class="line">  401241:	c3                   	retq   </span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun7</span><span class="params">(<span class="keyword">int</span> one, <span class="keyword">int</span> two)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (one == <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0xffffffff</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> edx = *one;</span><br><span class="line">        <span class="keyword">if</span> ( edx &lt;= two )&#123;</span><br><span class="line">            <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (edx == two)&#123;</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                one = *(one + <span class="number">0x10</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span> +fun7(one , two)*<span class="number">2</span>; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            one = *(one + <span class="number">0x8</span>);</span><br><span class="line">            <span class="keyword">return</span> fun7(one , two)*<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Once dump the memory <code>0x6030f0</code>, I was surprised to find that this is a binary tree</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">0x6030f0 &lt;n1&gt;:	0x0000000000000024	0x0000000000603110</span><br><span class="line">0x603100 &lt;n1+16&gt;:	0x0000000000603130	0x0000000000000000</span><br><span class="line">0x603110 &lt;n21&gt;:	0x0000000000000008	0x0000000000603190</span><br><span class="line">0x603120 &lt;n21+16&gt;:	0x0000000000603150	0x0000000000000000</span><br><span class="line">0x603130 &lt;n22&gt;:	0x0000000000000032	0x0000000000603170</span><br><span class="line">0x603140 &lt;n22+16&gt;:	0x00000000006031b0	0x0000000000000000</span><br><span class="line">0x603150 &lt;n32&gt;:	0x0000000000000016	0x0000000000603270</span><br><span class="line">0x603160 &lt;n32+16&gt;:	0x0000000000603230	0x0000000000000000</span><br><span class="line">0x603170 &lt;n33&gt;:	0x000000000000002d	0x00000000006031d0</span><br><span class="line">0x603180 &lt;n33+16&gt;:	0x0000000000603290	0x0000000000000000</span><br><span class="line">0x603190 &lt;n31&gt;:	0x0000000000000006	0x00000000006031f0</span><br><span class="line">0x6031a0 &lt;n31+16&gt;:	0x0000000000603250	0x0000000000000000</span><br><span class="line">0x6031b0 &lt;n34&gt;:	0x000000000000006b	0x0000000000603210</span><br><span class="line">0x6031c0 &lt;n34+16&gt;:	0x00000000006032b0	0x0000000000000000</span><br><span class="line">0x6031d0 &lt;n45&gt;:	0x0000000000000028	0x0000000000000000</span><br><span class="line">0x6031e0 &lt;n45+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6031f0 &lt;n41&gt;:	0x0000000000000001	0x0000000000000000</span><br><span class="line">0x603200 &lt;n41+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x603210 &lt;n47&gt;:	0x0000000000000063	0x0000000000000000</span><br><span class="line">0x603220 &lt;n47+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x603230 &lt;n44&gt;:	0x0000000000000023	0x0000000000000000</span><br><span class="line">0x603240 &lt;n44+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x603250 &lt;n42&gt;:	0x0000000000000007	0x0000000000000000</span><br><span class="line">0x603260 &lt;n42+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x603270 &lt;n43&gt;:	0x0000000000000014	0x0000000000000000</span><br><span class="line">0x603280 &lt;n43+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x603290 &lt;n46&gt;:	0x000000000000002f	0x0000000000000000</span><br><span class="line">0x6032a0 &lt;n46+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6032b0 &lt;n48&gt;:	0x00000000000003e9	0x0000000000000000</span><br><span class="line">0x6032c0 &lt;n48+16&gt;:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">      ....36....         </span><br><span class="line">     &#x2F;          \        </span><br><span class="line">   .8..        ..50.     </span><br><span class="line">  &#x2F;    \      &#x2F;     \    </span><br><span class="line">  6     22   45    107   </span><br><span class="line"> &#x2F; \   &#x2F; \   &#x2F; \   &#x2F;  \  </span><br><span class="line">1  7  20 35 40 0  99 1001</span><br><span class="line">&#x2F;\ &#x2F;\ &#x2F;\ &#x2F;\ &#x2F;\ &#x2F;\ &#x2F;\ &#x2F;  \</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//BST search for signal value</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fun7</span><span class="params">(<span class="keyword">int</span> * root, <span class="keyword">int</span> signal)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">NULL</span> )&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">int</span> value = *root; <span class="comment">//0x24 = 36</span></span><br><span class="line">        <span class="keyword">if</span> ( value &lt;= signal )&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (value == signal)&#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//root = *(root + 0x10); </span></span><br><span class="line">                root = root-&gt;right;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span> +fun7(root , signal)*<span class="number">2</span>; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//root = *(root + 0x8);</span></span><br><span class="line">            root = root-&gt;left;</span><br><span class="line">            <span class="keyword">return</span> fun7(root , signal)*<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>I was so tired to think, so just write some shity code to solve the problem</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BSTNode</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, parent, k</span>):</span></span><br><span class="line">        self.key = k</span><br><span class="line">        self.parent = parent</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insertleft</span>(<span class="params">self, node</span>):</span></span><br><span class="line">        <span class="keyword">if</span> node <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> self.left <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            node.parent = self</span><br><span class="line">            self.left = node</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.left.insertleft(node)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insertright</span>(<span class="params">self, node</span>):</span></span><br><span class="line">        <span class="keyword">if</span> node <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> self.right <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            node.parent = self</span><br><span class="line">            self.right = node</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.right.insertright(node)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fsearch</span>(<span class="params">self , target</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">        value = self.key</span><br><span class="line">        <span class="keyword">if</span> value &lt;= target:</span><br><span class="line">            <span class="keyword">if</span> value == target :</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> self.right == <span class="literal">None</span> : <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>+self.right.fsearch(target)*<span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> self.left == <span class="literal">None</span> : <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> self.left.fsearch(target) * <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n1  = BSTNode(<span class="literal">None</span> , <span class="number">0x24</span>)</span><br><span class="line"></span><br><span class="line">n21 = BSTNode(<span class="literal">None</span> , <span class="number">0x8</span>)</span><br><span class="line">n22 = BSTNode(<span class="literal">None</span> , <span class="number">0x32</span>)</span><br><span class="line">n32 = BSTNode(<span class="literal">None</span> , <span class="number">0x16</span>)</span><br><span class="line">n33 = BSTNode(<span class="literal">None</span> , <span class="number">0x2d</span>)</span><br><span class="line">n31 = BSTNode(<span class="literal">None</span> , <span class="number">0x06</span>)</span><br><span class="line">n34 = BSTNode(<span class="literal">None</span> , <span class="number">0x6b</span>)</span><br><span class="line">n45 = BSTNode(<span class="literal">None</span> , <span class="number">0x28</span>)</span><br><span class="line">n41 = BSTNode(<span class="literal">None</span> , <span class="number">0x1</span>)</span><br><span class="line">n47 = BSTNode(<span class="literal">None</span> , <span class="number">0x63</span>)</span><br><span class="line">n44 = BSTNode(<span class="literal">None</span> , <span class="number">0x23</span>)</span><br><span class="line">n42 = BSTNode(<span class="literal">None</span> , <span class="number">0x7</span>)</span><br><span class="line">n43 = BSTNode(<span class="literal">None</span> , <span class="number">0x14</span>)</span><br><span class="line">n46 = BSTNode(<span class="literal">None</span> , <span class="number">0x0</span>)</span><br><span class="line">n48 = BSTNode(<span class="literal">None</span> , <span class="number">0x3e9</span>)</span><br><span class="line"></span><br><span class="line">n1.insertleft(n21)</span><br><span class="line">n1.insertright(n22)</span><br><span class="line">n21.insertleft(n31)</span><br><span class="line">n21.insertright(n32)</span><br><span class="line">n22.insertleft(n33)</span><br><span class="line">n22.insertright(n34)</span><br><span class="line">n32.insertleft(n43)</span><br><span class="line">n32.insertright(n44)</span><br><span class="line">n33.insertleft(n45)</span><br><span class="line">n33.insertright(n46)</span><br><span class="line">n31.insertleft(n41)</span><br><span class="line">n31.insertright(n42)</span><br><span class="line">n34.insertleft(n47)</span><br><span class="line">n34.insertright(n48)</span><br><span class="line"></span><br><span class="line">ls = [<span class="number">0x8</span>,<span class="number">0x32</span>,<span class="number">0x16</span>,<span class="number">0x2d</span>,<span class="number">0x06</span>,<span class="number">0x6b</span>,<span class="number">0x28</span>,<span class="number">0x1</span>,<span class="number">0x63</span>,<span class="number">0x23</span>,<span class="number">0x7</span>,<span class="number">0x14</span>,<span class="number">0x0</span>,<span class="number">0x3e9</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ls :</span><br><span class="line">    print(n1.fsearch(i) , <span class="string">&quot;when search :&quot;</span> , i)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">0 when search : 8</span><br><span class="line">1 when search : 50</span><br><span class="line">2 when search : 22</span><br><span class="line">1 when search : 45</span><br><span class="line">0 when search : 6</span><br><span class="line">3 when search : 107</span><br><span class="line">1 when search : 40</span><br><span class="line">0 when search : 1</span><br><span class="line">3 when search : 99</span><br><span class="line">6 when search : 35</span><br><span class="line">4 when search : 7</span><br><span class="line">2 when search : 20</span><br><span class="line">-8 when search : 0</span><br><span class="line">7 when search : 1001</span><br></pre></td></tr></table></figure>
<p>Both 20 and 22 will do the favor for you</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Wow! You&#39;ve defused the secret stage!</span><br><span class="line">Congratulations! You&#39;ve defused the bomb!</span><br></pre></td></tr></table></figure>
<h3 id="End"><a href="#End" class="headerlink" title="End"></a>End</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ cat answer</span><br><span class="line">Border relations with Canada have never been better.</span><br><span class="line">1 2 4 8 16 32</span><br><span class="line">0 207</span><br><span class="line">7 0 DrEvil</span><br><span class="line">IONEFG</span><br><span class="line">4 3 2 1 6 5</span><br><span class="line">22</span><br><span class="line">$ ./bomb answer</span><br><span class="line">Welcome to my fiendish little bomb. You have 6 phases with</span><br><span class="line"><span class="built_in">which</span> to blow yourself up. Have a nice day!</span><br><span class="line">Phase 1 defused. How about the next one?</span><br><span class="line">That<span class="string">&#x27;s number 2.  Keep going!</span></span><br><span class="line"><span class="string">Halfway there!</span></span><br><span class="line"><span class="string">So you got that one.  Try this one.</span></span><br><span class="line"><span class="string">Good work!  On to the next...</span></span><br><span class="line"><span class="string">Curses, you&#x27;</span>ve found the secret phase!</span><br><span class="line">But finding it and solving it are quite different...</span><br><span class="line">Wow! You<span class="string">&#x27;ve defused the secret stage!</span></span><br><span class="line"><span class="string">Congratulations! You&#x27;</span>ve defused the bomb!</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://rubbish-and-world.github.io/2021/08/17/CSAPP/bomblab/" data-id="ckuxs0ufw0046aayq4wrt4528" data-title="bomblab" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/08/20/CSAPP/Ch4/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Ch4
        
      </div>
    </a>
  
  
    <a href="/2021/08/09/CSAPP/Ch3PartIV/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Ch3PartIV</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Cryptography/">Cryptography</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure/">Data Structure</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Electronics/">Electronics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine Learning</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/NTU/">NTU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/Stanford-CS229/">Stanford CS229</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Math/Discrete-Mathematics/">Discrete Mathematics</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Missing-Semester/">Missing Semester</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Networking/">Networking</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Networking/Stanford-CS144/">Stanford CS144</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python-OG/">Python OG</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/csapp/">csapp</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/" rel="tag">game</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/game/" style="font-size: 10px;">game</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/11/16/miscellaneous/NetworkProgrammingFAQ/">NetworkProgrammingFAQ</a>
          </li>
        
          <li>
            <a href="/2021/11/16/miscellaneous/Debug-libc/">Debug libc</a>
          </li>
        
          <li>
            <a href="/2021/10/24/CSAPP/Ch12/">Ch12</a>
          </li>
        
          <li>
            <a href="/2021/10/20/Missing%20Semester/ShellScripting/">ShellScripting</a>
          </li>
        
          <li>
            <a href="/2021/10/20/Missing%20Semester/Introduction/">Introduction</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 rubbish<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>